(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1143:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"uri",(function(){return ex_spec_uri})),__webpack_require__.d(__webpack_exports__,"uuid",(function(){return ex_spec_uuid})),__webpack_require__.d(__webpack_exports__,"seq",(function(){return ex_spec_seq})),__webpack_require__.d(__webpack_exports__,"keywordp",(function(){return ex_spec_keywordp})),__webpack_require__.d(__webpack_exports__,"arrp",(function(){return ex_spec_arrp})),__webpack_require__.d(__webpack_exports__,"set",(function(){return ex_spec_set})),__webpack_require__.d(__webpack_exports__,"obj",(function(){return ex_spec_obj})),__webpack_require__.d(__webpack_exports__,"mapOf",(function(){return ex_spec_mapOf})),__webpack_require__.d(__webpack_exports__,"Bytes65",(function(){return ex_spec_Bytes65})),__webpack_require__.d(__webpack_exports__,"lt",(function(){return ex_spec_lt})),__webpack_require__.d(__webpack_exports__,"enums",(function(){return ex_spec_enums})),__webpack_require__.d(__webpack_exports__,"boolean",(function(){return ex_spec_boolean})),__webpack_require__.d(__webpack_exports__,"booleanp",(function(){return ex_spec_booleanp})),__webpack_require__.d(__webpack_exports__,"map",(function(){return ex_spec_map})),__webpack_require__.d(__webpack_exports__,"char",(function(){return ex_spec_char})),__webpack_require__.d(__webpack_exports__,"addressType",(function(){return ex_spec_addressType})),__webpack_require__.d(__webpack_exports__,"networkId",(function(){return ex_spec_networkId})),__webpack_require__.d(__webpack_exports__,"blockRef",(function(){return ex_spec_blockRef})),__webpack_require__.d(__webpack_exports__,"any",(function(){return ex_spec_any})),__webpack_require__.d(__webpack_exports__,"neg",(function(){return ex_spec_neg})),__webpack_require__.d(__webpack_exports__,"objp",(function(){return ex_spec_objp})),__webpack_require__.d(__webpack_exports__,"indexed",(function(){return ex_spec_indexed})),__webpack_require__.d(__webpack_exports__,"zero",(function(){return ex_spec_zero})),__webpack_require__.d(__webpack_exports__,"objOf",(function(){return ex_spec_objOf})),__webpack_require__.d(__webpack_exports__,"qualifiedIdent",(function(){return ex_spec_qualifiedIdent})),__webpack_require__.d(__webpack_exports__,"defBase32AddressSchemaFactory",(function(){return ex_spec_defBase32AddressSchemaFactory})),__webpack_require__.d(__webpack_exports__,"cat",(function(){return ex_spec_cat})),__webpack_require__.d(__webpack_exports__,"schema",(function(){return ex_spec_schema})),__webpack_require__.d(__webpack_exports__,"explain",(function(){return ex_spec_explain})),__webpack_require__.d(__webpack_exports__,"oneOrMore",(function(){return ex_spec_oneOrMore})),__webpack_require__.d(__webpack_exports__,"asterisk",(function(){return ex_spec_asterisk})),__webpack_require__.d(__webpack_exports__,"zeroOrOne",(function(){return ex_spec_zeroOrOne})),__webpack_require__.d(__webpack_exports__,"epochTag",(function(){return ex_spec_epochTag})),__webpack_require__.d(__webpack_exports__,"Uint256",(function(){return ex_spec_Uint256})),__webpack_require__.d(__webpack_exports__,"double",(function(){return ex_spec_double})),__webpack_require__.d(__webpack_exports__,"dbid",(function(){return ex_spec_dbid})),__webpack_require__.d(__webpack_exports__,"questionMark",(function(){return ex_spec_questionMark})),__webpack_require__.d(__webpack_exports__,"jssetp",(function(){return ex_spec_jssetp})),__webpack_require__.d(__webpack_exports__,"zeroOrMore",(function(){return ex_spec_zeroOrMore})),__webpack_require__.d(__webpack_exports__,"fn",(function(){return ex_spec_fn})),__webpack_require__.d(__webpack_exports__,"stringp",(function(){return ex_spec_stringp})),__webpack_require__.d(__webpack_exports__,"orn",(function(){return ex_spec_orn})),__webpack_require__.d(__webpack_exports__,"intp",(function(){return ex_spec_intp})),__webpack_require__.d(__webpack_exports__,"jsinst",(function(){return ex_spec_jsinst})),__webpack_require__.d(__webpack_exports__,"inst",(function(){return ex_spec_inst})),__webpack_require__.d(__webpack_exports__,"eq",(function(){return ex_spec_eq})),__webpack_require__.d(__webpack_exports__,"validate",(function(){return ex_spec_validate})),__webpack_require__.d(__webpack_exports__,"int",(function(){return ex_spec_int})),__webpack_require__.d(__webpack_exports__,"undefine",(function(){return ex_spec_undefine})),__webpack_require__.d(__webpack_exports__,"number",(function(){return ex_spec_number})),__webpack_require__.d(__webpack_exports__,"rawSchema",(function(){return ex_spec_rawSchema})),__webpack_require__.d(__webpack_exports__,"alt",(function(){return ex_spec_alt})),__webpack_require__.d(__webpack_exports__,"seqable",(function(){return ex_spec_seqable})),__webpack_require__.d(__webpack_exports__,"vectorp",(function(){return ex_spec_vectorp})),__webpack_require__.d(__webpack_exports__,"password",(function(){return ex_spec_password})),__webpack_require__.d(__webpack_exports__,"qualifiedSymbol",(function(){return ex_spec_qualifiedSymbol})),__webpack_require__.d(__webpack_exports__,"ref",(function(){return ex_spec_ref})),__webpack_require__.d(__webpack_exports__,"falsep",(function(){return ex_spec_falsep})),__webpack_require__.d(__webpack_exports__,"sequential",(function(){return ex_spec_sequential})),__webpack_require__.d(__webpack_exports__,"float",(function(){return ex_spec_float})),__webpack_require__.d(__webpack_exports__,"arr",(function(){return ex_spec_arr})),__webpack_require__.d(__webpack_exports__,"setp",(function(){return ex_spec_setp})),__webpack_require__.d(__webpack_exports__,"symbol",(function(){return ex_spec_symbol})),__webpack_require__.d(__webpack_exports__,"maybe",(function(){return ex_spec_maybe})),__webpack_require__.d(__webpack_exports__,"associative",(function(){return ex_spec_associative})),__webpack_require__.d(__webpack_exports__,"natInt",(function(){return ex_spec_natInt})),__webpack_require__.d(__webpack_exports__,"or",(function(){return ex_spec_or})),__webpack_require__.d(__webpack_exports__,"nul",(function(){return ex_spec_nul})),__webpack_require__.d(__webpack_exports__,"re",(function(){return ex_spec_re})),__webpack_require__.d(__webpack_exports__,"negInt",(function(){return ex_spec_negInt})),__webpack_require__.d(__webpack_exports__,"some",(function(){return ex_spec_some})),__webpack_require__.d(__webpack_exports__,"coll",(function(){return ex_spec_coll})),__webpack_require__.d(__webpack_exports__,"tuple",(function(){return ex_spec_tuple})),__webpack_require__.d(__webpack_exports__,"pos",(function(){return ex_spec_pos})),__webpack_require__.d(__webpack_exports__,"not",(function(){return ex_spec_not})),__webpack_require__.d(__webpack_exports__,"Bytes32",(function(){return ex_spec_Bytes32})),__webpack_require__.d(__webpack_exports__,"gte",(function(){return ex_spec_gte})),__webpack_require__.d(__webpack_exports__,"tokenSymbol",(function(){return ex_spec_tokenSymbol})),__webpack_require__.d(__webpack_exports__,"empty",(function(){return ex_spec_empty})),__webpack_require__.d(__webpack_exports__,"defRestSchemas",(function(){return ex_spec_defRestSchemas})),__webpack_require__.d(__webpack_exports__,"string",(function(){return ex_spec_string})),__webpack_require__.d(__webpack_exports__,"vector",(function(){return ex_spec_vector})),__webpack_require__.d(__webpack_exports__,"k",(function(){return ex_spec_k})),__webpack_require__.d(__webpack_exports__,"qualifiedKeyword",(function(){return ex_spec_qualifiedKeyword})),__webpack_require__.d(__webpack_exports__,"epochRef",(function(){return ex_spec_epochRef})),__webpack_require__.d(__webpack_exports__,"mapp",(function(){return ex_spec_mapp})),__webpack_require__.d(__webpack_exports__,"symbolp",(function(){return ex_spec_symbolp})),__webpack_require__.d(__webpack_exports__,"posInt",(function(){return ex_spec_posInt})),__webpack_require__.d(__webpack_exports__,"altn",(function(){return ex_spec_altn})),__webpack_require__.d(__webpack_exports__,"integer",(function(){return ex_spec_integer})),__webpack_require__.d(__webpack_exports__,"regexp",(function(){return ex_spec_regexp})),__webpack_require__.d(__webpack_exports__,"Bytes",(function(){return ex_spec_Bytes})),__webpack_require__.d(__webpack_exports__,"doublep",(function(){return ex_spec_doublep})),__webpack_require__.d(__webpack_exports__,"hex",(function(){return ex_spec_hex})),__webpack_require__.d(__webpack_exports__,"Hash32",(function(){return ex_spec_Hash32})),__webpack_require__.d(__webpack_exports__,"list",(function(){return ex_spec_list})),__webpack_require__.d(__webpack_exports__,"catn",(function(){return ex_spec_catn})),__webpack_require__.d(__webpack_exports__,"keyword",(function(){return ex_spec_keyword})),__webpack_require__.d(__webpack_exports__,"multi",(function(){return ex_spec_multi})),__webpack_require__.d(__webpack_exports__,"chainId",(function(){return ex_spec_chainId})),__webpack_require__.d(__webpack_exports__,"neq",(function(){return ex_spec_neq})),__webpack_require__.d(__webpack_exports__,"gt",(function(){return ex_spec_gt})),__webpack_require__.d(__webpack_exports__,"truep",(function(){return ex_spec_truep})),__webpack_require__.d(__webpack_exports__,"anyp",(function(){return ex_spec_anyp})),__webpack_require__.d(__webpack_exports__,"sequentialp",(function(){return ex_spec_sequentialp})),__webpack_require__.d(__webpack_exports__,"plus",(function(){return ex_spec_plus})),__webpack_require__.d(__webpack_exports__,"ident",(function(){return ex_spec_ident})),__webpack_require__.d(__webpack_exports__,"url",(function(){return ex_spec_url})),__webpack_require__.d(__webpack_exports__,"repeat",(function(){return ex_spec_repeat})),__webpack_require__.d(__webpack_exports__,"Uint",(function(){return ex_spec_Uint})),__webpack_require__.d(__webpack_exports__,"lte",(function(){return ex_spec_lte})),__webpack_require__.d(__webpack_exports__,"and",(function(){return ex_spec_and})),__webpack_require__.d(__webpack_exports__,"blockTag",(function(){return ex_spec_blockTag})),__webpack_require__.d(__webpack_exports__,"uuidp",(function(){return ex_spec_uuidp})),__webpack_require__.d(__webpack_exports__,"simpleIdent",(function(){return ex_spec_simpleIdent})),__webpack_require__.d(__webpack_exports__,"Byte",(function(){return ex_spec_Byte})),__webpack_require__.d(__webpack_exports__,"Bytes256",(function(){return ex_spec_Bytes256})),__webpack_require__.d(__webpack_exports__,"f",(function(){return ex_spec_f})),__webpack_require__.d(__webpack_exports__,"optParam",(function(){return ex_spec_optParam})),__webpack_require__.d(__webpack_exports__,"$APP",(function(){return shared.a})),__webpack_require__.d(__webpack_exports__,"shadow$provide",(function(){return shared.c})),__webpack_require__.d(__webpack_exports__,"$jscomp",(function(){return shared.b})),__webpack_require__.d(__webpack_exports__,"ethHexAddress",(function(){return ethHexAddress})),__webpack_require__.d(__webpack_exports__,"hexUserAddress",(function(){return hexUserAddress})),__webpack_require__.d(__webpack_exports__,"hexContractAddress",(function(){return hexContractAddress})),__webpack_require__.d(__webpack_exports__,"hexBuiltInAddress",(function(){return hexBuiltInAddress})),__webpack_require__.d(__webpack_exports__,"hexNullAddress",(function(){return hexNullAddress})),__webpack_require__.d(__webpack_exports__,"mnemonic",(function(){return mnemonic})),__webpack_require__.d(__webpack_exports__,"privateKey",(function(){return privateKey})),__webpack_require__.d(__webpack_exports__,"hdPath",(function(){return hdPath})),__webpack_require__.d(__webpack_exports__,"cfxHexAddress",(function(){return cfxHexAddress})),__webpack_require__.d(__webpack_exports__,"base32Address",(function(){return base32Address})),__webpack_require__.d(__webpack_exports__,"base32UserAddress",(function(){return base32UserAddress})),__webpack_require__.d(__webpack_exports__,"base32ContractAddress",(function(){return base32ContractAddress})),__webpack_require__.d(__webpack_exports__,"base32BuiltinAddress",(function(){return base32BuiltinAddress})),__webpack_require__.d(__webpack_exports__,"base32NullAddress",(function(){return base32NullAddress})),__webpack_require__.d(__webpack_exports__,"nickname",(function(){return nickname})),__webpack_require__.d(__webpack_exports__,"optionalMapKey",(function(){return optionalMapKey}));var ex_spec_uri,ex_spec_uuid,ex_spec_seq,ex_spec_keywordp,ex_spec_arrp,ex_spec_set,ex_spec_obj,ex_spec_mapOf,ex_spec_Bytes65,ex_spec_lt,ex_spec_enums,ex_spec_boolean,ex_spec_booleanp,ex_spec_map,ex_spec_char,ex_spec_addressType,ex_spec_networkId,ex_spec_blockRef,ex_spec_any,ex_spec_neg,ex_spec_objp,ex_spec_indexed,ex_spec_zero,ex_spec_objOf,ex_spec_qualifiedIdent,ex_spec_defBase32AddressSchemaFactory,ex_spec_cat,ex_spec_schema,ex_spec_explain,ex_spec_oneOrMore,ex_spec_asterisk,ex_spec_zeroOrOne,ex_spec_epochTag,ex_spec_Uint256,ex_spec_double,ex_spec_dbid,ex_spec_questionMark,ex_spec_jssetp,ex_spec_zeroOrMore,ex_spec_fn,ex_spec_stringp,ex_spec_orn,ex_spec_intp,ex_spec_jsinst,ex_spec_inst,ex_spec_eq,ex_spec_validate,ex_spec_int,ex_spec_undefine,ex_spec_number,ex_spec_rawSchema,ex_spec_alt,ex_spec_seqable,ex_spec_vectorp,ex_spec_password,ex_spec_qualifiedSymbol,ex_spec_ref,ex_spec_falsep,ex_spec_sequential,ex_spec_float,ex_spec_arr,ex_spec_setp,ex_spec_symbol,ex_spec_maybe,ex_spec_associative,ex_spec_natInt,ex_spec_or,ex_spec_nul,ex_spec_re,ex_spec_negInt,ex_spec_some,ex_spec_coll,ex_spec_tuple,ex_spec_pos,ex_spec_not,ex_spec_Bytes32,ex_spec_gte,ex_spec_tokenSymbol,ex_spec_empty,ex_spec_defRestSchemas,ex_spec_string,ex_spec_vector,ex_spec_k,ex_spec_qualifiedKeyword,ex_spec_epochRef,ex_spec_mapp,ex_spec_symbolp,ex_spec_posInt,ex_spec_altn,ex_spec_integer,ex_spec_regexp,ex_spec_Bytes,ex_spec_doublep,ex_spec_hex,ex_spec_Hash32,ex_spec_list,ex_spec_catn,ex_spec_keyword,ex_spec_multi,ex_spec_chainId,ex_spec_neq,ex_spec_gt,ex_spec_truep,ex_spec_anyp,ex_spec_sequentialp,ex_spec_plus,ex_spec_ident,ex_spec_url,ex_spec_repeat,ex_spec_Uint,ex_spec_lte,ex_spec_and,ex_spec_blockTag,ex_spec_uuidp,ex_spec_simpleIdent,ex_spec_Byte,ex_spec_Bytes256,ex_spec_f,ex_spec_optParam,xu,kv,lv,mv,nv,ov,shared=__webpack_require__(1148),uu=function(a){return shared.a.Sf((function(b){return!shared.a.Md(b)}),shared.a.Yc(function(a){return function d(c){return new shared.a.Ue(null,(function(){if(shared.a.x(shared.a.Md.g?shared.a.Md.g(c):shared.a.Md.call(null,c))){var e=shared.a.O([shared.a.F.g?shared.a.F.g(c):shared.a.F.call(null,c)]);e=shared.a.lf(shared.a.co,shared.a.mf(shared.a.V,d,e))}else e=null;return shared.a.Ie(c,e)}),null)}(a)}(a)))},vu=function(a,b,c){return new shared.a.Ue(null,(function(){var d=shared.a.F(c);if(d){var e=shared.a.ho.h(a,d);return a===shared.a.K(e)?shared.a.Ie(e,vu(a,b,shared.a.Pf(b,d))):null}return null}),null)},wu=function(a){return shared.a.oi(a,shared.a.O([shared.a.pi,!0]))},zu=function(a,b){return shared.a.x(shared.a.Cf(shared.a.Dh([b]),xu))?new shared.a.W(null,2,5,shared.a.X,[b,new shared.a.v(null,1,[yu,a],null)],null):b},Au=function(a,b){return shared.a.Zh.g(["base32",shared.a.x(a)?["-",shared.a.x(b)?[shared.a.A.g(a),"-",shared.a.A.g(b)].join(""):shared.a.A.g(a)].join(""):shared.a.x(b)?["-",shared.a.A.g(b)].join(""):"","-address"].join(""))},spec_Bu=function Bu(a,b){return function(a,b,c){if(shared.a.Ee(c)){var d=shared.a.lf(shared.a.Z,shared.a.V.h(a,c));return b.g?b.g(d):b.call(null,d)}return shared.a.ng(c)?(d=new shared.a.he((e=shared.a.Pb(c),a.g?a.g(e):a.call(null,e)),function(){var e=shared.a.Qb(c);return a.g?a.g(e):a.call(null,e)}()),b.g?b.g(d):b.call(null,d)):shared.a.Vd(c)?(d=shared.a.Oh(shared.a.V.h(a,c)),b.g?b.g(d):b.call(null,d)):shared.a.Od(c)?(d=shared.a.ob((function(e,f){return shared.a.R.h(e,a.g?a.g(f):a.call(null,f))}),c,c),b.g?b.g(d):b.call(null,d)):shared.a.Jd(c)?(d=shared.a.Wf.h(shared.a.zd(c),shared.a.V.h(a,c)),b.g?b.g(d):b.call(null,d)):b.g?b.g(c):b.call(null,c);var e}(shared.a.Ff(Bu,a),a,b)},Cu=new shared.a.T(null,"privateKey","privateKey",1845961641),Du=new shared.a.T(null,"hexContractAddress","hexContractAddress",-893096304),Eu=new shared.a.T(null,"randomPrivateKey","randomPrivateKey",1183021577),Fu=new shared.a.T(null,"epoch-ref","epoch-ref",-48908512),Gu=new shared.a.T(null,"randomHexAddress","randomHexAddress",1570574414),Hu=new shared.a.T(null,"uint","uint",521409576),Iu=new shared.a.T(null,"hexBuiltInAddress","hexBuiltInAddress",1280085039),Ju=new shared.a.T(null,"undefined","undefined",-1970511116),Ku=new shared.a.T(null,"validateHDPath","validateHDPath",-1924266109),Lu=new shared.a.T(null,"bytes-256","bytes-256",-339812064),Mu=new shared.a.T(null,"js-set","js-set",855005610),Nu=new shared.a.T(null,"generateMnemonic","generateMnemonic",-1133348254),Ou=new shared.a.T(null,"address-type","address-type",921859604),yu=new shared.a.T(null,"netId","netId",-280816369),Pu=new shared.a.T(null,"bytes-32","bytes-32",953912278),Qu=new shared.a.T(null,"uint-256","uint-256",582839198),Ru=new shared.a.T(null,"hexUserAddress","hexUserAddress",1842704561),Su=new shared.a.T(null,"bytes-65","bytes-65",469917002),Tu=new shared.a.T(null,"INTERNAL_CONTRACTS_HEX_ADDRESS","INTERNAL_CONTRACTS_HEX_ADDRESS",1890509993),Uu=new shared.a.T(null,"abc","abc",-1232035677),Vu=new shared.a.T(null,"randomHDPath","randomHDPath",-672829199),Wu=new shared.a.T(null,"js-date","js-date",-66554654),Xu=new shared.a.T(null,"optional-param","optional-param",745881564),Yu=new shared.a.T("cfxjs.spec.core","schema","cfxjs.spec.core/schema",-2104791549),Zu=new shared.a.T(null,"hexNullAddress","hexNullAddress",-1249531275),$u=new shared.a.T(null,"url","url",276297046),av=new shared.a.T(null,"epoch-tag","epoch-tag",-1905188154),bv=new shared.a.T(null,"hd-path","hd-path",-1739234499),cv=new shared.a.T(null,"hash-32","hash-32",1821363454),dv=new shared.a.T(null,"validateMnemonic","validateMnemonic",-1802951577),ev=new shared.a.T(null,"dbid","dbid",-196647356),fv=new shared.a.T(null,"hexString","hexString",608989661),gv=new shared.a.T(null,"validatePrivateKey","validatePrivateKey",2114592353),hv=new shared.a.T(null,"byte","byte",683775220),iv=new shared.a.T(null,"network-id","network-id",-1769267262),jv=new shared.a.T(null,"bytes","bytes",1175866680),spec_pv=function pv(a){switch(arguments.length){case 1:return pv.g(arguments[0]);case 2:return pv.h(arguments[0],arguments[1]);default:throw Error(["Invalid arity: ",shared.a.A.g(arguments.length)].join(""))}};spec_pv.g=function(a){return spec_pv.h(a,shared.a.xf)},spec_pv.h=function(a,b){return a=wu(a),b=shared.a.Q.h(b,yu),shared.a.x(b)?spec_Bu(shared.a.Ff(zu,b),a):a},spec_pv.A=2;var spec_qv=function qv(a){switch(arguments.length){case 1:return qv.g(arguments[0]);case 2:return qv.h(arguments[0],arguments[1]);case 3:return qv.i(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",shared.a.A.g(arguments.length)].join(""))}};spec_qv.g=function(a){return spec_qv.i(a,void 0,shared.a.xf)},spec_qv.h=function(a,b){return spec_qv.i(a,b,shared.a.xf)},spec_qv.i=function(a,b,c){return c=wu(c),a=shared.a.ti(spec_pv)(a,c),b=shared.a.qi(b),shared.a.$l(a,b,c)},spec_qv.A=3;var spec_rv=function rv(a){switch(arguments.length){case 2:return rv.h(arguments[0],arguments[1]);case 3:return rv.i(arguments[0],arguments[1],arguments[2]);default:throw Error(["Invalid arity: ",shared.a.A.g(arguments.length)].join(""))}};spec_rv.h=function(a,b){return spec_rv.i(a,b,shared.a.xf)},spec_rv.i=function(a,b,c){return c=wu(c),a=shared.a.ti(spec_pv)(a,c),b=shared.a.qi(b),b=shared.a.cm(a,c)(b,shared.a.Uf,shared.a.Uf),b=shared.a.Pm(b),shared.a.so(b)},spec_rv.A=3;var spec_sv=function sv(a){for(var c=[],d=arguments.length,e=0;e<d;)c.push(arguments[e]),e+=1;return sv.j(arguments[0],1<c.length?new shared.a.Uc(c.slice(1),0,null):null)};spec_sv.j=function(a,b){b=vu(2,2,b);var c=shared.a.I(b),d=shared.a.P(c,0,null);return c=shared.a.P(c,1,null),d=shared.a.O([shared.a.Pd(d)?d:new shared.a.W(null,1,5,shared.a.X,[d],null),c]),a=shared.a.Mk(a,null),a=shared.a.Yl(shared.a.ik(a),shared.a.tf(shared.a.mf(shared.a.io,shared.a.fk(a),d)),shared.a.hk(a),shared.a.gk(a)),b=uu(shared.a.Yc(b)),shared.a.Id(b)?a:shared.a.mf(spec_sv,a,b)},spec_sv.A=1,spec_sv.C=function(a){var b=shared.a.I(a);return a=shared.a.J(a),this.j(b,a)};var tv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Ho,new shared.a.v(null,2,[shared.a.uk,8,shared.a.vk,128],null)],null),shared.a.O([shared.a.Lr,"String between 8 to 128 character",shared.a.Y,shared.a.xo])),uv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.jr,new shared.a.v(null,2,[shared.a.uk,0,shared.a.vk,4294967295],null)],null),shared.a.O([shared.a.Y,iv,shared.a.Lr,"1029 for mainnet, 1 for testnet, 0 <= networkId <= 4294967295"])),vv=spec_sv.j(new shared.a.W(null,5,5,shared.a.X,[shared.a.qq,"user","contract","builtin","null"],null),shared.a.O([shared.a.Y,Ou,shared.a.Lr,"Is string, one of user contract builtin null"])),wv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0(x|X)?[a-fA-F0-9]+$/],null),shared.a.O([shared.a.Y,fv,shared.a.fq,function(){return["0x",shared.a.A.g(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))].join("")},shared.a.Dm,"invalid hex string",shared.a.Lr,"hexadecimal string"])),xv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x([0-9a-fA-F]?){1,2}$/],null),shared.a.O([shared.a.Y,hv,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"hex encoded byte"],null)])),yv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[0-9a-f]*$/],null),shared.a.O([shared.a.Y,jv,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"hex encoded bytes"],null)])),zv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[0-9a-f]{64}$/],null),shared.a.O([shared.a.Y,Pu,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"32 hex encoded bytes"],null)])),Av=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[0-9a-f]{512}$/],null),shared.a.O([shared.a.Y,Lu,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"256 hex encoded bytes"],null)])),Bv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[0-9a-f]{512}$/],null),shared.a.O([shared.a.Y,Su,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"65 hex encoded bytes"],null)])),Cv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[1-9a-f]+[0-9a-f]*$/],null),shared.a.O([shared.a.Y,Hu,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"hex encoded unsigned integer"],null)])),Dv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[0-9a-f]{64}$/],null),shared.a.O([shared.a.Y,Qu,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"hex encoded unsigned integer"],null)])),Ev=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[0-9a-f]{64}$/],null),shared.a.O([shared.a.Y,cv,new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"32 byte hex value"],null)])),Fv=spec_sv.j(Cv,shared.a.O([new shared.a.W(null,2,5,shared.a.X,[shared.a.Lr,"chainid, 0x-prefixed hexadecimal string"],null)])),Gv=shared.a.pt(new shared.a.v(null,3,[shared.a.Y,Wu,shared.a.ym,function(a){try{return shared.a.fd(a)||shared.a.fd(new Date(a))}catch(b){if(b instanceof Error)return!1;throw b}},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,"should be a valid date string",shared.a.Lr,"valid js date string",shared.a.fq,function(){function a(c){var d=null;if(0<arguments.length){d=0;for(var e=Array(arguments.length-0);d<e.length;)e[d]=arguments[d+0],++d;d=new shared.a.Uc(e,0,null)}return b.call(this,d)}function b(){return(new Date).toISOString()}return a.A=0,a.C=function(c){return c=shared.a.F(c),b()},a.j=b,a}()],null)],null)),Hv=shared.a.pt(new shared.a.v(null,3,[shared.a.Y,Mu,shared.a.ym,function(a){return shared.a.Pd(a)&&shared.a.M.h(shared.a.K(shared.a.Wf.h(shared.a.Ch,a)),shared.a.K(a))},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,"should be a array without duplicate item",shared.a.Lr,"array without duplicate item",shared.a.fq,function(){function a(c){var d=null;if(0<arguments.length){d=0;for(var e=Array(arguments.length-0);d<e.length;)e[d]=arguments[d+0],++d;d=new shared.a.Uc(e,0,null)}return b.call(this,d)}function b(){return new shared.a.Bh(null,new shared.a.v(null,4,[Uu,null,"a",null,3,null,!1,null],null),null)}return a.A=0,a.C=function(c){return c=shared.a.F(c),b()},a.j=b,a}()],null)],null)),Iv=shared.a.pt(new shared.a.v(null,3,[shared.a.Y,shared.a.jq,shared.a.ym,shared.a.bb,shared.a.El,new shared.a.v(null,3,[shared.a.Dm,"should be null or cljs nil",shared.a.Lr,"javascript null or cljs nil",shared.a.fq,function(){function a(b){if(0<arguments.length)for(var c=0,d=Array(arguments.length-0);c<d.length;)d[c]=arguments[c+0],++c;return null}return a.A=0,a.C=function(b){return shared.a.F(b),null},a.j=function(){return null},a}()],null)],null)),Jv=RegExp,Kv=shared.a.pt(new shared.a.v(null,3,[shared.a.Y,Ju,shared.a.ym,function(){return shared.a.M.g(void 0)},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,"should be undefined",shared.a.Lr,"javascript undefined",shared.a.fq,function(){function a(b){if(0<arguments.length)for(var c=0,d=Array(arguments.length-0);c<d.length;)d[c]=arguments[c+0],++c}return a.A=0,a.C=function(b){shared.a.F(b)},a.j=function(){},a}()],null)],null)),Lv=spec_sv.j(new shared.a.W(null,7,5,shared.a.X,[shared.a.qq,"latest_mined","latest_confirmed","latest_state","latest_checkpoint","earliest",null],null),shared.a.O([shared.a.Y,av,shared.a.Dm,"must be one of latest_mined, latest_confirmed, latest_state, latest_checkpoint, earliest or null",shared.a.Lr,"one of latest_mined, latest_confirmed, latest_state, latest_checkpoint, earliest or null, default to latest_state"])),Mv=spec_sv.j(new shared.a.W(null,3,5,shared.a.X,[shared.a.Yo,Lv,wv],null),shared.a.O([shared.a.Y,Fu,shared.a.Dm,"invalid epoch ref, check the doc at https://developer.conflux-chain.org/conflux-doc/docs/json_rpc#the-epoch-number-parameter",shared.a.Lr,"epoch number tag, check the doc at https://developer.conflux-chain.org/conflux-doc/docs/json_rpc#the-epoch-number-parameter"])),Nv=spec_sv.j(new shared.a.W(null,5,5,shared.a.X,[shared.a.qq,"latest","earliest","pending",null],null),shared.a.O([shared.a.Y,av,shared.a.Dm,"invalid block tag, must be one of latest pending or earliest",shared.a.Lr,"one of latest pending or earliest, default to latest"])),Ov=spec_sv.j(new shared.a.W(null,3,5,shared.a.X,[shared.a.Yo,Nv,wv],null),shared.a.O([shared.a.Y,Fu,shared.a.Dm,"invalid block ref, must be one of latest, pending, earliest, block number or null",shared.a.Lr,"one of latest, pending, earliest, block number or null"]));spec_sv.j(new shared.a.W(null,4,5,shared.a.X,[shared.a.qq,"builtin","user","contract"],null),shared.a.O([shared.a.Y,Ou,shared.a.Dm,"invalid conflux user type, must be one of builtin user contract",shared.a.Lr,"one of builtin user contract"]));var Pv=spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^(?:(?:https?):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))?\.?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i],null),shared.a.O([shared.a.fq,function(){return"https://example.com/"},shared.a.Y,$u,shared.a.Dm,"invalid http/https url",shared.a.Lr,"http/https url"])),Qv=spec_sv.j(new shared.a.W(null,4,5,shared.a.X,[shared.a.Yo,Kv,Iv,new shared.a.W(null,3,5,shared.a.X,[shared.a.Xp,shared.a.Pd,shared.a.Id],null)],null),shared.a.O([shared.a.Y,Xu,shared.a.Lr,"undefined, null or empty array"])),Rv=spec_sv.j(shared.a.ae,shared.a.O([shared.a.Y,ev,shared.a.Dm,"invalid dbid, must be a positive integer",shared.a.Lr,"database id, positive integer"])),Sv=spec_sv.j(new shared.a.W(null,3,5,shared.a.X,[shared.a.Xp,new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^[a-zA-Z0-9+\-%\/$]+$/],null),new shared.a.W(null,2,5,shared.a.X,[shared.a.Ho,new shared.a.v(null,2,[shared.a.uk,1,shared.a.vk,20],null)],null)],null),shared.a.O([shared.a.Dm,"invalid token symbol",shared.a.Lr,"token symbol"]));ex_spec_uri=shared.a.Ni,ex_spec_uuid=shared.a.Rq,ex_spec_seq=shared.a.Vd,ex_spec_keywordp=shared.a.Ke,ex_spec_arrp=shared.a.Pd,ex_spec_set=shared.a.hp,ex_spec_obj=shared.a.Ur,ex_spec_mapOf=shared.a.nq,ex_spec_Bytes65=Bv,ex_spec_lt=shared.a.qp,ex_spec_enums=shared.a.qq,ex_spec_boolean=shared.a.Ro,ex_spec_booleanp=shared.a.Ud,ex_spec_map=shared.a.Ur,ex_spec_char=shared.a.ib,ex_spec_addressType=vv,ex_spec_networkId=uv,ex_spec_blockRef=Ov,ex_spec_any=shared.a.dq,ex_spec_neg=shared.a.Be,ex_spec_objp=shared.a.Nd,ex_spec_indexed=shared.a.qd,ex_spec_zero=shared.a.Ae,ex_spec_objOf=shared.a.nq,ex_spec_qualifiedIdent=shared.a.Pe,ex_spec_defBase32AddressSchemaFactory=function(a,b){return kv=shared.a.pt((function(c){c=shared.a.U(c);var d=shared.a.Q.h(c,yu);return new shared.a.v(null,3,[shared.a.Y,Au(null,d),shared.a.ym,function(e){return a.h?a.h(e,d):a.call(null,e,d)},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,["Invalid base32 address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.Lr,["Base32 address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.fq,function(){return b.call(null,d)}],null)],null)})),lv=shared.a.pt((function(c){c=shared.a.U(c);var d=shared.a.Q.h(c,yu);return new shared.a.v(null,3,[shared.a.Y,Au("user",d),shared.a.ym,function(e){return a.i?a.i(e,"user",d):a.call(null,e,"user",d)},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,["Invalid base32 user address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.Lr,["Base32 user address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.fq,function(){return b.call(null,d)}],null)],null)})),mv=shared.a.pt((function(c){c=shared.a.U(c);var d=shared.a.Q.h(c,yu);return new shared.a.v(null,3,[shared.a.Y,Au("contract",d),shared.a.ym,function(e){return a.i?a.i(e,"contract",d):a.call(null,e,"contract",d)},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,["Invalid base32 contract address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.Lr,["Base32 contract address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.fq,function(){return b.call(null,d)}],null)],null)})),nv=shared.a.pt((function(c){c=shared.a.U(c);var d=shared.a.Q.h(c,yu);return new shared.a.v(null,3,[shared.a.Y,Au("builtin",d),shared.a.ym,function(e){return a.i?a.i(e,"builtin",d):a.call(null,e,"builtin",d)},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,["Invalid base32 builtin address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.Lr,["Base32 builtin address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.fq,function(){return b.call(null,d)}],null)],null)})),ov=shared.a.pt((function(c){c=shared.a.U(c);var d=shared.a.Q.h(c,yu);return new shared.a.v(null,3,[shared.a.Y,Au("null",d),shared.a.ym,function(e){return a.i?a.i(e,"null",d):a.call(null,e,"null",d)},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,["Invalid base32 null address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.Lr,["Base32 null address",shared.a.x(d)?[", with network id ",shared.a.A.g(d)].join(""):""].join(""),shared.a.fq,function(){return b.call(null,d)}],null)],null)})),xu=new shared.a.W(null,5,5,shared.a.X,[kv,lv,mv,nv,ov],null)},ex_spec_cat=shared.a.dr,ex_spec_schema=shared.a.gl,ex_spec_explain=spec_rv,ex_spec_oneOrMore=shared.a.mr,ex_spec_asterisk=shared.a.lq,ex_spec_zeroOrOne=shared.a.xr,ex_spec_epochTag=Lv,ex_spec_Uint256=Dv,ex_spec_double=shared.a.zr,ex_spec_dbid=Rv,ex_spec_questionMark=shared.a.xr,ex_spec_jssetp=Hv,ex_spec_zeroOrMore=shared.a.lq,ex_spec_fn=shared.a.gs,ex_spec_stringp=shared.a.hb,ex_spec_orn=shared.a.ys,ex_spec_intp=shared.a.$d,ex_spec_jsinst=Gv,ex_spec_inst=shared.a.fd,ex_spec_eq=shared.a.Zq,ex_spec_validate=spec_qv,ex_spec_int=shared.a.jr,ex_spec_undefine=Kv,ex_spec_number=shared.a.db,ex_spec_rawSchema=Yu,ex_spec_alt=shared.a.Rp,ex_spec_seqable=shared.a.Wd,ex_spec_vectorp=shared.a.Pd,ex_spec_password=tv,ex_spec_qualifiedSymbol=shared.a.Gq,ex_spec_ref=shared.a.Pk,ex_spec_falsep=shared.a.Sd,ex_spec_sequential=shared.a.is,ex_spec_float=shared.a.de,ex_spec_arr=shared.a.Er,ex_spec_setp=shared.a.Kd,ex_spec_symbol=shared.a.Ar,ex_spec_maybe=shared.a.rq,ex_spec_associative=shared.a.Ld,ex_spec_natInt=shared.a.ce,ex_spec_or=shared.a.Yo,ex_spec_nul=Iv,ex_spec_re=shared.a.Bl,ex_spec_negInt=shared.a.be,ex_spec_some=shared.a.fb,ex_spec_coll=shared.a.Jd,ex_spec_tuple=shared.a.zs,ex_spec_pos=shared.a.ze,ex_spec_not=shared.a.Dq,ex_spec_Bytes32=zv,ex_spec_gte=shared.a.zo,ex_spec_tokenSymbol=Sv,ex_spec_empty=shared.a.Id,ex_spec_defRestSchemas=function(a){a=wu(a),a=shared.a.U(a);var b=shared.a.Q.h(a,Tu),c=shared.a.Q.h(a,Gu),d=shared.a.Q.h(a,Eu),e=shared.a.Q.h(a,dv),f=shared.a.Q.h(a,Nu),g=shared.a.Q.h(a,gv),h=shared.a.Q.h(a,Ku),k=shared.a.Q.h(a,Vu);return a=shared.a.qi(b),{hdPath:shared.a.pt(new shared.a.v(null,3,[shared.a.Y,bv,shared.a.ym,function(l){var n="string"==typeof l;return n?h.g?h.g(l):h.call(null,l):n},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,"should be a valid hdPath without the last address index",shared.a.Lr,"hd wallet derivation path without the last address_index, check https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki#abstract for detail",shared.a.fq,function(){return k.call()}],null)],null)),mnemonic:shared.a.pt(new shared.a.v(null,3,[shared.a.Y,shared.a.bq,shared.a.ym,function(l){var n="string"==typeof l;return n?e.g?e.g(l):e.call(null,l):n},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,"should be a valid mnemonic",shared.a.Lr,"Mnemonic phrase",shared.a.fq,function(){return f.call()}],null)],null)),privateKey:shared.a.pt(new shared.a.v(null,3,[shared.a.Y,Cu,shared.a.ym,function(l){return g.g?g.g(l):g.call(null,l)},shared.a.El,new shared.a.v(null,3,[shared.a.Dm,"invalid private key",shared.a.Lr,"0x-prefixed private key",shared.a.fq,function(){return d.call()}],null)],null)),ethHexAddress:spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x[0-9a-fA-F]{40}$/],null),shared.a.O([shared.a.fq,function(){return c.call()},shared.a.Dm,"invalid hex address",shared.a.Lr,"0x-prefixed address"])),hexUserAddress:spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x1[0-9a-fA-F]{39}$/],null),shared.a.O([shared.a.Y,Ru,shared.a.fq,function(){return c.call(null,"user")},shared.a.Dm,"invalid hex user address",shared.a.Lr,"Conflux hex user address"])),hexContractAddress:spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Bl,/^0x8[0-9a-fA-F]{39}$/],null),shared.a.O([shared.a.Y,Du,shared.a.Dm,"invalid hex contract address",shared.a.Lr,"Conflux hex user address",shared.a.fq,function(){return c.call(null,"contract")}])),hexBuiltInAddress:spec_sv.j(shared.a.Wf.h(new shared.a.W(null,1,5,shared.a.X,[shared.a.qq],null),a),shared.a.O([shared.a.Y,Iu,shared.a.Dm,["invalid hex builtin address, can only be one of ",shared.a.A.g(a)].join(""),shared.a.Lr,"Hex address of conflux internal contract, can be found at https://confluxscan.io/contracts",shared.a.Fo,a])),hexNullAddress:spec_sv.j(new shared.a.W(null,2,5,shared.a.X,[shared.a.Zq,"0x0000000000000000000000000000000000000000"],null),shared.a.O([shared.a.Y,Zu,shared.a.Lr,"Null address: 0x0000000000000000000000000000000000000000",shared.a.Dm,"invalid hex null address, should be 0x0000000000000000000000000000000000000000"]))}},ex_spec_string=shared.a.Ho,ex_spec_vector=shared.a.Er,ex_spec_k=shared.a.Zh,ex_spec_qualifiedKeyword=shared.a.Up,ex_spec_epochRef=Mv,ex_spec_mapp=shared.a.Nd,ex_spec_symbolp=shared.a.Pc,ex_spec_posInt=shared.a.ae,ex_spec_altn=shared.a.Hq,ex_spec_integer=shared.a.Zd,ex_spec_regexp=Jv,ex_spec_Bytes=yv,ex_spec_doublep=shared.a.ee,ex_spec_hex=wv,ex_spec_Hash32=Ev,ex_spec_list=shared.a.Ee,ex_spec_catn=shared.a.Br,ex_spec_keyword=shared.a.As,ex_spec_multi=shared.a.cq,ex_spec_chainId=Fv,ex_spec_neq=shared.a.ks,ex_spec_gt=shared.a.Vq,ex_spec_truep=shared.a.Td,ex_spec_anyp=shared.a.jb,ex_spec_sequentialp=shared.a.Md,ex_spec_plus=shared.a.mr,ex_spec_ident=shared.a.Ne,ex_spec_url=Pv,ex_spec_repeat=shared.a.Do,ex_spec_Uint=Cv,ex_spec_lte=shared.a.Xo,ex_spec_and=shared.a.Xp,ex_spec_blockTag=Nv,ex_spec_uuidp=shared.a.Ki,ex_spec_simpleIdent=shared.a.Oe,ex_spec_Byte=xv,ex_spec_Bytes256=Av,ex_spec_f=shared.a.ml,ex_spec_optParam=Qv;var consts=__webpack_require__(1165),account=__webpack_require__(1153),src=__webpack_require__(1179),base32_address=__webpack_require__(1147),hdkey=__webpack_require__(1160);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var _defRestSchemas=ex_spec_defRestSchemas({INTERNAL_CONTRACTS_HEX_ADDRESS:consts.e,NULL_HEX_ADDRESS:consts.f,validatePrivateKey:account.g,randomHexAddress:account.d,randomCfxHexAddress:account.c,randomPrivateKey:account.e,validateMnemonic:src.validateMnemonic,generateMnemonic:src.generateMnemonic,validateHDPath:hdkey.c,randomHDPath:hdkey.b}),ethHexAddress=_defRestSchemas.ethHexAddress,hexUserAddress=_defRestSchemas.hexUserAddress,hexContractAddress=_defRestSchemas.hexContractAddress,hexBuiltInAddress=_defRestSchemas.hexBuiltInAddress,hexNullAddress=_defRestSchemas.hexNullAddress,mnemonic=_defRestSchemas.mnemonic,privateKey=_defRestSchemas.privateKey,hdPath=_defRestSchemas.hdPath,cfxHexAddress=[ex_spec_or,hexUserAddress,hexContractAddress,hexBuiltInAddress,hexNullAddress],_defBase32AddressSche2=_slicedToArray(ex_spec_defBase32AddressSchemaFactory(base32_address.d,base32_address.c),5),base32Address=_defBase32AddressSche2[0],base32UserAddress=_defBase32AddressSche2[1],base32ContractAddress=_defBase32AddressSche2[2],base32BuiltinAddress=_defBase32AddressSche2[3],base32NullAddress=_defBase32AddressSche2[4],nickname=[ex_spec_stringp,{min:1,max:128,doc:"Nickname of this account, a string with 1 to 128 characters"}],optionalMapKey=function(s){if(3===s.length){var _s2=_slicedToArray(s,3),k=_s2[0],opt=_s2[1],v=_s2[2];return[k,Object.assign({},opt,{optional:!0}),v]}if(2===s.length){var _s3=_slicedToArray(s,2);return[_s3[0],{optional:!0},_s3[1]]}throw new Error("unsupported spec")}},1147:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(Buffer){__webpack_require__.d(__webpack_exports__,"b",(function(){return encode})),__webpack_require__.d(__webpack_exports__,"a",(function(){return decode})),__webpack_require__.d(__webpack_exports__,"d",(function(){return validateBase32Address})),__webpack_require__.d(__webpack_exports__,"c",(function(){return randomBase32Address}));var _fluent_wallet_account__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1153),_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1158),js_conflux_sdk__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1207),_thi_ng_memoize__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1440),_thi_ng_memoize__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1442),_thi_ng_cache__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1441),encode=Object(_thi_ng_memoize__WEBPACK_IMPORTED_MODULE_3__.a)((function(hexAddress,netId,verbose){return js_conflux_sdk__WEBPACK_IMPORTED_MODULE_2__.address.encodeCfxAddress(Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_1__.a)(hexAddress),netId,verbose)}),new _thi_ng_cache__WEBPACK_IMPORTED_MODULE_5__.a(null,{maxlen:200})),decode=Object(_thi_ng_memoize__WEBPACK_IMPORTED_MODULE_4__.a)((function(a){try{var rst=js_conflux_sdk__WEBPACK_IMPORTED_MODULE_2__.address.decodeCfxAddress(a);return rst.hexAddress=Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_1__.a)(rst.hexAddress.toString("hex")),rst}catch(err){var _err$message;if(null!=err&&null!==(_err$message=err.message)&&void 0!==_err$message&&_err$message.includes("Invalid attempt to destructure non-iterable instance"))throw new Error("Invalid checksum");throw err}}),new _thi_ng_cache__WEBPACK_IMPORTED_MODULE_5__.a(null,{maxlen:200}));function validateBase32Address(address){var netId,type,decoded,valid=!1;if(null!=(arguments.length<=1?void 0:arguments[1]))if(Number.isSafeInteger(arguments.length<=1?void 0:arguments[1]))netId=arguments.length<=1?void 0:arguments[1];else{if("string"!=typeof(arguments.length<=1?void 0:arguments[1]))throw new Error("Invalid type or networkId, type must be string, networkId must be number");type=arguments.length<=1?void 0:arguments[1]}if(null!=(arguments.length<=2?void 0:arguments[2]))if(Number.isSafeInteger(arguments.length<=2?void 0:arguments[2]))netId=arguments.length<=2?void 0:arguments[2];else{if("string"!=typeof(arguments.length<=2?void 0:arguments[2]))throw new Error("Invalid type or networkId, type must be string, networkId must be number");type=arguments.length<=2?void 0:arguments[2]}try{decoded=decode(address),valid=!0,void 0!==netId&&netId!==decoded.netId&&(valid=!1),void 0!==type&&type!==decoded.type&&(valid=!1)}catch(err){valid=!1}return valid}var randomBase32Address=function(){var netId,type;if(null!=(arguments.length<=0?void 0:arguments[0]))if(Number.isSafeInteger(arguments.length<=0?void 0:arguments[0]))netId=arguments.length<=0?void 0:arguments[0];else{if("string"!=typeof(arguments.length<=0?void 0:arguments[0]))throw new Error("Invalid type or networkId, type must be string, networkId must be number");type=arguments.length<=0?void 0:arguments[0]}if(null!=(arguments.length<=1?void 0:arguments[1]))if(Number.isSafeInteger(arguments.length<=1?void 0:arguments[1]))netId=arguments.length<=1?void 0:arguments[1];else{if("string"!=typeof(arguments.length<=1?void 0:arguments[1]))throw new Error("Invalid type or networkId, type must be string, networkId must be number");type=arguments.length<=1?void 0:arguments[1]}void 0===type&&(type=Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_0__.b)()),void 0===netId&&(netId=1029);var hexAddress=Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_1__.c)(Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_0__.d)(type));return encode(Buffer.from(hexAddress,"hex"),netId)}}).call(this,__webpack_require__(56).Buffer)},1153:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return fromPrivate})),__webpack_require__.d(__webpack_exports__,"f",(function(){return toAccountAddress})),__webpack_require__.d(__webpack_exports__,"d",(function(){return randomHexAddress})),__webpack_require__.d(__webpack_exports__,"b",(function(){return randomAddressType})),__webpack_require__.d(__webpack_exports__,"c",(function(){return randomCfxHexAddress})),__webpack_require__.d(__webpack_exports__,"e",(function(){return randomPrivateKey})),__webpack_require__.d(__webpack_exports__,"g",(function(){return validatePrivateKey}));var _ethersproject_address__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1155),_ethersproject_transactions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1170),_ethersproject_wallet__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1230),_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1158),_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1167),_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1165),create=function(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},pk=_ref.pk,kp=pk?new _ethersproject_wallet__WEBPACK_IMPORTED_MODULE_2__.a(pk):_ethersproject_wallet__WEBPACK_IMPORTED_MODULE_2__.a.createRandom();return kp},fromPrivate=(Object(_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_4__.a)(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.a,_ethersproject_address__WEBPACK_IMPORTED_MODULE_0__.a),function(pk){return{address:Object(_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_4__.c)(pk,_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.a,_ethersproject_transactions__WEBPACK_IMPORTED_MODULE_1__.a),privateKey:Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.a)(pk)}}),toAccountAddress=function(address){return address.replace(/^0x./,"0x1")},randomHexAddress=function(type){if(type&&!_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_5__.a.includes(type))throw new Error(`Invalid address type ${type}`);if("builtin"===type)return _fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_5__.e[Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.b)(_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_5__.e.length)];if("null"===type)return _fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_5__.f;var addr=create().address;return"user"===type?toAccountAddress(addr):"contract"===type?addr.replace(/^0x./,"0x8"):addr},randomAddressType=function(){return _fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_5__.a[Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.b)(_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_5__.a.length)]},randomCfxHexAddress=function(){return randomHexAddress(randomAddressType())},randomPrivateKey=function(){return create().privateKey},validatePrivateKey=function(privateKey){var valid=!1;try{var rst=fromPrivate(privateKey);valid=Boolean(rst.address)}catch(err){valid=!1}return valid}},1158:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return randomInt})),__webpack_require__.d(__webpack_exports__,"d",(function(){return toBuffer})),__webpack_require__.d(__webpack_exports__,"a",(function(){return addHexPrefix}));__webpack_require__(135);var buffer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(56),bn_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1355),bn_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(bn_js__WEBPACK_IMPORTED_MODULE_2__),strip_hex_prefix__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1172),strip_hex_prefix__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(strip_hex_prefix__WEBPACK_IMPORTED_MODULE_3__),is_hex_prefixed__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1166),is_hex_prefixed__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(is_hex_prefixed__WEBPACK_IMPORTED_MODULE_4__);__webpack_require__.d(__webpack_exports__,"c",(function(){return strip_hex_prefix__WEBPACK_IMPORTED_MODULE_3___default.a}));var randomInt=function(a){return Math.floor(Math.random()*a)};function padToEven(value){var a=value;if("string"!=typeof a)throw new Error(`[@fluent-wallet/utils] while padding to even, value must be string, is currently ${typeof a}, while padToEven.`);return a.length%2&&(a=`0${a}`),a}var toBuffer=function(v){if(!buffer__WEBPACK_IMPORTED_MODULE_1__.Buffer.isBuffer(v))if(Array.isArray(v))v=buffer__WEBPACK_IMPORTED_MODULE_1__.Buffer.from(v);else if("string"==typeof v){if(!function isHexString(value,length){if("string"!=typeof value||!value.match(/^0x[0-9A-Fa-f]*$/))return!1;if(length&&value.length!==2+2*length)return!1;return!0}(v))throw new Error(`Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ${v}`);v=buffer__WEBPACK_IMPORTED_MODULE_1__.Buffer.from(padToEven(strip_hex_prefix__WEBPACK_IMPORTED_MODULE_3___default()(v)),"hex")}else if("number"==typeof v)v=function intToBuffer(i){var hex=function intToHex(i){return`0x${i.toString(16)}`}(i);return new buffer__WEBPACK_IMPORTED_MODULE_1__.Buffer(padToEven(hex.slice(2)),"hex")}(v);else if(null==v)v=buffer__WEBPACK_IMPORTED_MODULE_1__.Buffer.allocUnsafe(0);else if(bn_js__WEBPACK_IMPORTED_MODULE_2___default.a.isBN(v))v=v.toArrayLike(buffer__WEBPACK_IMPORTED_MODULE_1__.Buffer);else{if(!v.toArray)throw new Error("invalid type");v=buffer__WEBPACK_IMPORTED_MODULE_1__.Buffer.from(v.toArray())}return v};var addHexPrefix=function(str){return"string"!=typeof str||is_hex_prefixed__WEBPACK_IMPORTED_MODULE_4___default()(str)?str:"0x"+str}},1159:function(module,__webpack_exports__,__webpack_require__){"use strict";var _thi_ng_checks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1154);__webpack_require__.d(__webpack_exports__,"a",(function(){return _thi_ng_checks__WEBPACK_IMPORTED_MODULE_0__.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _thi_ng_checks__WEBPACK_IMPORTED_MODULE_0__.b})),__webpack_require__.d(__webpack_exports__,"c",(function(){return _thi_ng_checks__WEBPACK_IMPORTED_MODULE_0__.c}));__webpack_require__(1227)},1160:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return randomHDPath})),__webpack_require__.d(__webpack_exports__,"c",(function(){return validateHDPath})),__webpack_require__.d(__webpack_exports__,"a",(function(){return getNthAccountOfHDKey}));var _fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1158),_ethersproject_hdnode__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1187),_ethersproject_random__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1439);function randomHDPathIndex(){return Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__.b)(2147483648)}var randomHDPath=function(){return`m/44'/${randomHDPathIndex()}'/${randomHDPathIndex()}'/${Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__.b)(randomHDPathIndex())}`},validateHDPath=function(hdPath){var valid=!0;try{var paths=hdPath.split("/");valid=(valid=valid&&5===paths.length&&"m"===paths[0]&&"44'"===paths[1]&&paths[2].endsWith("'")&&paths[3].endsWith("'"))&&Boolean(_ethersproject_hdnode__WEBPACK_IMPORTED_MODULE_1__.a.fromMnemonic(Object(_ethersproject_hdnode__WEBPACK_IMPORTED_MODULE_1__.c)(Object(_ethersproject_random__WEBPACK_IMPORTED_MODULE_2__.a)(16))).derivePath(paths.join("/")))}catch(err){valid=!1}return valid},getNthAccountOfHDKey=async function(_ref){for(var mnemonic=_ref.mnemonic,_ref$hdPath=_ref.hdPath,hdPath=void 0===_ref$hdPath?"m/44'/503'/0'/0":_ref$hdPath,nth=_ref.nth,_ref$only0x1Prefixed=_ref.only0x1Prefixed,only0x1Prefixed=void 0!==_ref$only0x1Prefixed&&_ref$only0x1Prefixed,k=function(mnemonic){return _ethersproject_hdnode__WEBPACK_IMPORTED_MODULE_1__.a.fromMnemonic(mnemonic)}(mnemonic),paths=hdPath.split("/"),result={},count=0,idx=0;count<=nth;){paths[5]=idx++;var newNode=k.derivePath(paths.join("/"));result.address=newNode.address.toLowerCase(),result.privateKey=newNode.privateKey,only0x1Prefixed&&result.address.startsWith("0x1")&&count++,only0x1Prefixed||count++}return result.index=idx-1,result}},1165:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",(function(){return NULL_HEX_ADDRESS})),__webpack_require__.d(__webpack_exports__,"e",(function(){return INTERNAL_CONTRACTS_HEX_ADDRESS})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ADDRESS_TYPES})),__webpack_require__.d(__webpack_exports__,"b",(function(){return CFX_MAINNET_NETID})),__webpack_require__.d(__webpack_exports__,"c",(function(){return DEFAULT_CFX_HDPATH})),__webpack_require__.d(__webpack_exports__,"d",(function(){return DEFAULT_ETH_HDPATH}));var NULL_HEX_ADDRESS="0x0000000000000000000000000000000000000000",INTERNAL_CONTRACTS_HEX_ADDRESS=["0x0888000000000000000000000000000000000000","0x0888000000000000000000000000000000000001","0x0888000000000000000000000000000000000002"],ADDRESS_TYPES=["user","contract","builtin","null"],CFX_MAINNET_NETID=1029,DEFAULT_CFX_HDPATH="m/44'/503'/0'/0",DEFAULT_ETH_HDPATH="m/44'/60'/0'/0"},1167:function(module,__webpack_exports__,__webpack_require__){"use strict";var _thi_ng_compose__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1188);__webpack_require__.d(__webpack_exports__,"a",(function(){return _thi_ng_compose__WEBPACK_IMPORTED_MODULE_0__.a})),__webpack_require__.d(__webpack_exports__,"b",(function(){return _thi_ng_compose__WEBPACK_IMPORTED_MODULE_0__.b})),__webpack_require__.d(__webpack_exports__,"c",(function(){return _thi_ng_compose__WEBPACK_IMPORTED_MODULE_0__.c}))},1181:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return personalSign})),__webpack_require__.d(__webpack_exports__,"b",(function(){return hashTypedData})),__webpack_require__.d(__webpack_exports__,"d",(function(){return signTypedData_v4})),__webpack_require__.d(__webpack_exports__,"a",(function(){return cfxSignTransaction}));var _fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1158),buffer__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(1147),__webpack_require__(56)),_ethersproject_signing_key__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(1438),__webpack_require__(1174)),js_conflux_sdk__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1207),_ethersproject_bytes__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1144),_ethersproject_wallet__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1230),cip_23__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(1170),__webpack_require__(1443)),eth_sig_util__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1374),_ethersproject_keccak256__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1151);async function personalSign(type,privateKey,message){return"cfx"===type?js_conflux_sdk__WEBPACK_IMPORTED_MODULE_5__.PersonalMessage.sign(Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__.a)(privateKey),buffer__WEBPACK_IMPORTED_MODULE_2__.Buffer.from(message)):await new _ethersproject_wallet__WEBPACK_IMPORTED_MODULE_7__.a(Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__.a)(privateKey)).signMessage(message)}async function hashTypedData(type,typedData){return Object(_ethersproject_keccak256__WEBPACK_IMPORTED_MODULE_11__.a)(Object(cip_23__WEBPACK_IMPORTED_MODULE_9__.a)(typedData,!1,"cfx"===type?"CIP23Domain":"EIP712Domain"))}async function signTypedData_v4(type,privateKey,typedData){if("cfx"===type){var hashedMessage=Object(_ethersproject_keccak256__WEBPACK_IMPORTED_MODULE_11__.a)(Object(cip_23__WEBPACK_IMPORTED_MODULE_9__.a)(typedData,!1,"cfx"===type?"CIP23Domain":"EIP712Domain"));return js_conflux_sdk__WEBPACK_IMPORTED_MODULE_5__.Message.sign(Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__.d)(privateKey),Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__.d)(hashedMessage))}var digest=eth_sig_util__WEBPACK_IMPORTED_MODULE_10__.TypedDataUtils.sign(typedData),signature=new _ethersproject_signing_key__WEBPACK_IMPORTED_MODULE_4__.a(Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_0__.a)(privateKey)).signDigest(digest);return Object(_ethersproject_bytes__WEBPACK_IMPORTED_MODULE_6__.l)(signature)}var cfxSignTransaction=function(tx,pk,netId){return new js_conflux_sdk__WEBPACK_IMPORTED_MODULE_5__.Transaction(tx).sign(pk,netId).serialize()}},1186:function(module,__webpack_exports__,__webpack_require__){"use strict";var _fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1147),_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1165),_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1153),ADDR_TYPE_TO_PREFIX={user:"0x1",contract:"0x8",null:"0x0",builtin:"0x0"};__webpack_exports__.a=function(){var _ref=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},address=_ref.address,networkType=_ref.networkType,networkId=_ref.networkId,addressType=_ref.addressType,privateKey=_ref.privateKey;if("string"!=typeof address)throw new Error("Invalid address, must be a string");if(!["cfx","eth"].includes(networkType))throw new Error("Invalid networkType, must be cfx or eth");if(null!=networkId&&!Number.isSafeInteger(networkId))throw new Error("Invalid networkId, must be a safe integer");if("cfx"===networkType&&!Number.isSafeInteger(networkId))throw new Error("Invalid networkId, must be a safe integer");if(addressType&&!_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_1__.a.includes(addressType))throw new Error("Invalid addressType, must be one of "+_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_1__.a.toString());if("cfx"===networkType){if("null"===addressType&&(address="0x0000000000000000000000000000000000000000"),Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_0__.d)(address,networkId,addressType))return address;if(address.includes(":")){if(addressType&&!Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_0__.d)(address,addressType))throw new Error("Invalid base32 address, address type is invalid");return Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_0__.b)(Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_0__.a)(address).hexAddress,networkId)}return addressType||(addressType="user"),Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_0__.b)(address.toLowerCase().replace(/0x./,ADDR_TYPE_TO_PREFIX[addressType]),networkId)}if("eth"===networkType){if(address.includes(":")){if(privateKey)return Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_2__.a)(privateKey).address;throw new Error("Unable to convert base32 address into eth hex address without private key")}return address}}},1225:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function(_ref){var map=_ref.map,ethHexAddress=_ref.ethHexAddress,Hash32=_ref.Hash32,Uint=_ref.Uint,Byte=_ref.Byte,Bytes=_ref.Bytes,and=_ref.and,eq=_ref.eq,chainId=_ref.chainId,catn=_ref.catn,optionalMapKey=_ref.optionalMapKey,AccessEntrySpec=[map,{closed:!0},["address",{optional:!0},ethHexAddress],["storageKeys",{optional:!0},[catn,["32BtyeHexValue",Hash32]]]],AccessListSpec=[catn,["AccessListEntry",AccessEntrySpec]],TxMapSpecs={from:["from",ethHexAddress],type:["type",{doc:"EIP 2718 Type"},Byte],nonce:["nonce",Uint],to:["to",{doc:"Only optional when creating contract"},ethHexAddress],gas:["gas",{doc:"gas limit"},Uint],gasPrice:["gasPrice",{doc:"gas price"},Uint],value:["value",Uint],data:["data",{doc:"input data"},Bytes],maxPriorityFeePerGas:["maxPriorityFeePerGas",Uint],maxFeePerGas:["maxFeePerGas",Uint],accessList:["accessList",AccessListSpec],chainId:["chainId",chainId]};return{AccessEntrySpec:AccessEntrySpec,AccessListSpec:AccessListSpec,TxMapSpecs:TxMapSpecs,Transaction2930Unsigned:[map,{closed:!0},TxMapSpecs.from,[TxMapSpecs.type[0],optionalMapKey(TxMapSpecs.type)[1],[and,TxMapSpecs.type[2],[eq,"0x1"]]],optionalMapKey(TxMapSpecs.nonce),optionalMapKey(TxMapSpecs.to),optionalMapKey(TxMapSpecs.gas),optionalMapKey(TxMapSpecs.value),optionalMapKey(TxMapSpecs.data),optionalMapKey(TxMapSpecs.gasPrice),optionalMapKey(TxMapSpecs.accessList),optionalMapKey(TxMapSpecs.chainId)],Transaction1559Unsigned:[map,{closed:!0},TxMapSpecs.from,[TxMapSpecs.type[0],optionalMapKey(TxMapSpecs.type)[1],[and,TxMapSpecs.type[2],[eq,"0x2"]]],optionalMapKey(TxMapSpecs.nonce),optionalMapKey(TxMapSpecs.to),optionalMapKey(TxMapSpecs.gas),optionalMapKey(TxMapSpecs.value),optionalMapKey(TxMapSpecs.data),TxMapSpecs.maxPriorityFeePerGas,TxMapSpecs.maxFeePerGas,optionalMapKey(TxMapSpecs.accessList),optionalMapKey(TxMapSpecs.chainId)],TransactionLegacyUnsigned:[map,{closed:!0},TxMapSpecs.from,optionalMapKey(TxMapSpecs.nonce),optionalMapKey(TxMapSpecs.to),optionalMapKey(TxMapSpecs.gas),optionalMapKey(TxMapSpecs.value),optionalMapKey(TxMapSpecs.data),optionalMapKey(TxMapSpecs.gasPrice),optionalMapKey(TxMapSpecs.chainId)]}}},1226:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return chan}));var _thi_ng_csp__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1448);__webpack_require__(1159);function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function chan(){return _construct(_thi_ng_csp__WEBPACK_IMPORTED_MODULE_0__.a,Array.prototype.slice.call(arguments))}_thi_ng_csp__WEBPACK_IMPORTED_MODULE_0__.a.fromPromise},1229:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return validateTokenInfo}));var _ethersproject_abi__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1454),_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1167);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var iface=new _ethersproject_abi__WEBPACK_IMPORTED_MODULE_0__.a([{inputs:[{internalType:"address",name:"tokenHolder",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"pure",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"holder",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"granularity",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"send",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"holder",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}]),request=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var methodName=args[0],r=args[1],to=args[2],rest=args.slice(3);if(2===args.length)return Object(_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_1__.b)(request,methodName,r);if(3===args.length&&iface.getFunction(methodName).inputs.length>0)return Object(_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_1__.b)(request,methodName,r,to);var data=iface.encodeFunctionData(methodName,rest);return r({data:data,to:to}).then((function(res){var _res,_res2;return null!==(_res=res)&&void 0!==_res&&_res.jsonrpc&&null!==(_res2=res)&&void 0!==_res2&&_res2.result&&(res=res.result),iface.decodeFunctionResult(methodName,res)}))};async function validateTokenInfo(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];var callMethod=args[0],_args$=args[1],symbol=_args$.symbol,name=_args$.name,decimals=_args$.decimals,address=_args$.address,userAddress=_args$.userAddress;if(1===args.length)return Object(_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_1__.b)(validateTokenInfo,args[0]);var rst={valid:!0};try{var _balance$,_balance$$toHexString,calls=[contractInterface.symbol(callMethod,address),contractInterface.name(callMethod,address),contractInterface.decimals(callMethod,address)];userAddress&&calls.push(contractInterface.balanceOf(callMethod,address,userAddress));var _await$Promise$all=await Promise.all(calls),_await$Promise$all2=_slicedToArray(_await$Promise$all,4),_await$Promise$all2$=_slicedToArray(_await$Promise$all2[0],1),symbolRst=_await$Promise$all2$[0],_await$Promise$all2$2=_slicedToArray(_await$Promise$all2[1],1),nameRst=_await$Promise$all2$2[0],_await$Promise$all2$3=_slicedToArray(_await$Promise$all2[2],1),decimalsRst=_await$Promise$all2$3[0],balance=_await$Promise$all2[3];rst.symbol=symbolRst,symbol&&symbolRst!==symbol&&(rst.valid=!1),rst.name=nameRst,name&&nameRst!==name&&(rst.valid=!1),rst.decimals=decimalsRst,void 0!==decimals&&parseInt(decimalsRst)!==parseInt(decimals)&&(rst.valid=!1),balance&&(rst.balance=null==balance||null===(_balance$=balance[0])||void 0===_balance$||null===(_balance$$toHexString=_balance$.toHexString)||void 0===_balance$$toHexString?void 0:_balance$$toHexString.call(_balance$))}catch(err){rst.valid=!1}return rst}var contractInterface=new Proxy(iface,{get:function(){var _arguments=Array.prototype.slice.call(arguments),methodName=_arguments[1],f=iface.getFunction(methodName);if(!f)throw new Error(`Invalid contract method ${methodName}`);return Object(_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_1__.b)(request,methodName)}});__webpack_exports__.a=contractInterface},1356:function(module,exports){},1379:function(module,exports){},1381:function(module,exports){},1405:function(module,exports){},1418:function(module,exports){},243:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"generateMain",(function(){return generateMain})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_switchEthereumChain",publicSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["chainId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.chainId]]],innerSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["authReqId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["chainConfig",publicSchema]],schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,publicSchema,innerSchema]},permissions={external:["inpage","popup"],methods:["wallet_setCurrentNetwork","wallet_addPendingUserAuthRequest","wallet_userApprovedAuthRequest","wallet_userRejectedAuthRequest"],db:["getNetwork","getAuthReqById"],scope:{wallet_networks:{}}},generateMain=function(type){return async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getNetwork=_ref$db.getNetwork,getAuthReqById=_ref$db.getAuthReqById,_ref$rpcs=_ref.rpcs,wallet_setCurrentNetwork=_ref$rpcs.wallet_setCurrentNetwork,wallet_addPendingUserAuthRequest=_ref$rpcs.wallet_addPendingUserAuthRequest,wallet_userApprovedAuthRequest=_ref$rpcs.wallet_userApprovedAuthRequest,wallet_userRejectedAuthRequest=_ref$rpcs.wallet_userRejectedAuthRequest,params=_ref.params,app=_ref.app,_popup=_ref._popup,_inpage=_ref._inpage,currentNetwork=_ref.network,chainId=(Array.isArray(params)?params[0]:params.chainConfig[0]).chainId;if(currentNetwork.type===type&&currentNetwork.chainId===chainId)return"__null__";var network=_slicedToArray(getNetwork({chainId:chainId,type:type})||[],1)[0];if(!network)throw InvalidParams(`No ethereum network with chainId ${chainId}, try add the network with wallet_addEthereumChain`);if(_inpage)return await wallet_addPendingUserAuthRequest({appId:app.eid,req:{method:"cfx"===type?"wallet_switchConfluxChain":NAME,params:params}});if(_popup){var authReqId=params.authReqId;if(!getAuthReqById(authReqId))throw InvalidParams(`Invalid auth req id ${authReqId}`);var rst=await wallet_setCurrentNetwork([network.eid]);return null!=rst&&rst.error?await wallet_userRejectedAuthRequest({authReqId:authReqId}):await wallet_userApprovedAuthRequest({authReqId:authReqId,res:"__null__"})}}},main=generateMain("eth")},244:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"gen",(function(){return gen})),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var packages_spec=__webpack_require__(1143),signature=__webpack_require__(1181),base32_address=__webpack_require__(1147);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var map=packages_spec.map,dbid=packages_spec.dbid,or=packages_spec.or;function validateAndFormatTypedDataString(_ref){var typedData,type=_ref.type,typedDataString=_ref.typedDataString,spec=_ref.spec,InvalidParams=_ref.InvalidParams;try{typedData=JSON.parse(typedDataString)}catch(err){throw InvalidParams("Invalid typed data, can't parse with JSON.parse")}var typedDataSpec=function(type,spec){if("cfx"!==type&&"eth"!==type)throw new Error("Invalid type ${type}");var map=spec.map,mapOf=spec.mapOf,and=spec.and,stringp=spec.stringp,plus=spec.plus,mapp=spec.mapp;if(!map)throw new Error("Invalid spec instance");var typePropsSpec=[plus,[map,{closed:!0},["name",stringp],["type",stringp]]];return[map,{closed:!0},["types",[and,[map,["eth"===type?"EIP712Domain":"CIP23Domain",typePropsSpec]],[mapOf,stringp,typePropsSpec]]],["primaryType",{doc:"needs to be defined in types"},stringp],["domain",mapp],["message",mapp]]}(type,spec);if(!spec.validate(typedDataSpec,typedData))throw InvalidParams(`Invalid typed data\n${JSON.stringify(spec.explain(typedDataSpec,typedData))}`);try{Object(signature.b)(type,typedData)}catch(err){throw InvalidParams(`Error hashing typed data:\n${err.message}`)}return typedData}var cat=packages_spec.cat,ethHexAddress=packages_spec.ethHexAddress,base32UserAddress=packages_spec.base32UserAddress,stringp=packages_spec.stringp,gen={schemas:function(type){var publicSchema=[cat,"cfx"===type?base32UserAddress:ethHexAddress,[stringp,{doc:"typedDataString"}]];return{input:[or,publicSchema,[map,{closed:!0},["authReqId",dbid],["data",publicSchema]]]}},main:function(type){return async function(_ref2){var _ref2$Err=_ref2.Err,InvalidParams=_ref2$Err.InvalidParams,Unauthorized=_ref2$Err.Unauthorized,UserRejected=_ref2$Err.UserRejected,_ref2$db=_ref2.db,getAuthReqById=_ref2$db.getAuthReqById,accountAddrByNetwork=_ref2$db.accountAddrByNetwork,_ref2$rpcs=_ref2.rpcs,wallet_getAddressPrivateKey=_ref2$rpcs.wallet_getAddressPrivateKey,wallet_addPendingUserAuthRequest=_ref2$rpcs.wallet_addPendingUserAuthRequest,wallet_userApprovedAuthRequest=_ref2$rpcs.wallet_userApprovedAuthRequest,wallet_userRejectedAuthRequest=_ref2$rpcs.wallet_userRejectedAuthRequest,app=_ref2.app,params=_ref2.params,_inpage=_ref2._inpage,_popup=_ref2._popup;if(_inpage){var _params=_slicedToArray(params,2),from=_params[0],typedDataString=_params[1],addr=accountAddrByNetwork({account:app.currentAccount.eid,network:app.currentNetwork.eid});if("cfx"===type&&from.toLowerCase()!==addr.base32.toLowerCase())throw Unauthorized();if("eth"===type&&from.toLowerCase()!==addr.hex.toLowerCase())throw Unauthorized();if(validateAndFormatTypedDataString({type:type,typedDataString:typedDataString,spec:packages_spec,InvalidParams:InvalidParams}),"pub"===addr.vault.type)throw UserRejected();var req={method:NAME,params:params};return wallet_addPendingUserAuthRequest({appId:app.eid,req:req})}if(_popup){var authReqId=params.authReqId,_params$data=_slicedToArray(params.data,2),_from=_params$data[0],_typedDataString=_params$data[1],authReq=getAuthReqById(authReqId);if(!authReq)throw InvalidParams(`Invalid auth req id ${authReqId}`);var _addr=accountAddrByNetwork({account:authReq.app.currentAccount.eid,network:authReq.app.currentNetwork.eid});if("pub"===_addr.vault.type)return wallet_userRejectedAuthRequest({authReqId:authReqId});if("cfx"===type&&Object(base32_address.a)(_from).hexAddress!==_addr.cfxHex.toLowerCase())return wallet_userRejectedAuthRequest({authReqId:authReqId});if("eth"===type&&_from.toLowerCase()!==_addr.hex.toLowerCase())return wallet_userRejectedAuthRequest({authReqId:authReqId});var typedData=validateAndFormatTypedDataString({type:type,typedDataString:_typedDataString,spec:packages_spec,InvalidParams:InvalidParams}),pk=_addr.pk||await wallet_getAddressPrivateKey({addressId:_addr.eid}),sig=await Object(signature.d)(type,pk,typedData);return await wallet_userApprovedAuthRequest({authReqId:authReqId,res:sig})}}}},NAME="cfx_signTypedData_v4",schemas=gen.schemas("cfx"),permissions={external:["inpage","popup"],db:["getAuthReqById","accountAddrByNetwork"],methods:["wallet_getAddressPrivateKey","wallet_addPendingUserAuthRequest","wallet_userApprovedAuthRequest","wallet_userRejectedAuthRequest"],scope:{wallet_accounts:{}}},main=gen.main("cfx")},248:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_requestAccounts",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["inpage"],methods:["wallet_requestPermissions"],db:["getOneApp","accountAddrByNetwork"],scope:null},main=async function(_ref){var _ref$db=_ref.db,getOneApp=_ref$db.getOneApp,accountAddrByNetwork=_ref$db.accountAddrByNetwork,wallet_requestPermissions=_ref.rpcs.wallet_requestPermissions,site=_ref.site,app=_ref.app;if(null!=app&&app.currentAccount)return accountAddrByNetwork({account:app.currentAccount.eid,network:app.currentNetwork.eid}).base32;var permsRes=await wallet_requestPermissions([{cfx_accounts:{}}]);if(permsRes&&!permsRes.error){var newapp=getOneApp({site:site.eid}),currentAccount=newapp.currentAccount,currentNetwork=newapp.currentNetwork;return accountAddrByNetwork({account:currentAccount.eid,network:currentNetwork.eid}).base32}return permsRes}},249:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_signature__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1181);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="cfx_signTransaction",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["from",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress],["to",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32Address],["value",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["nonce",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["data",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Bytes],["gas",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["gasPrice",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["storageLimit",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["chainId",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.chainId],["epochHeight",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint]],[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.zeroOrOne,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochRef]]},permissions={external:[],methods:["wallet_getAddressPrivateKey","cfx_getNextNonce","cfx_epochNumber","cfx_estimateGasAndCollateral","wallet_detectAddressType"],db:["getFromAddress"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,getFromAddress=_ref.db.getFromAddress,_ref$rpcs=_ref.rpcs,wallet_getAddressPrivateKey=_ref$rpcs.wallet_getAddressPrivateKey,cfx_epochNumber=_ref$rpcs.cfx_epochNumber,cfx_estimateGasAndCollateral=_ref$rpcs.cfx_estimateGasAndCollateral,cfx_getNextNonce=_ref$rpcs.cfx_getNextNonce,wallet_detectAddressType=_ref$rpcs.wallet_detectAddressType,_ref$params=_slicedToArray(_ref.params,2),tx=_ref$params[0],epoch=_ref$params[1],network=_ref.network,newTx=Object.assign({},tx),_newTx=newTx,from=_newTx.from,data=_newTx.data,to=_newTx.to,gas=_newTx.gas,gasPrice=_newTx.gasPrice,nonce=_newTx.nonce,value=_newTx.value,chainId=_newTx.chainId,storageLimit=_newTx.storageLimit,epochHeight=_newTx.epochHeight;if(chainId&&chainId!==network.chainId)throw InvalidParams(`Invalid chainId ${chainId}`);var fromAddr=getFromAddress({networkId:network.eid,address:from});if(!fromAddr)throw InvalidParams(`Invalid from address ${from}`);if(!to&&!data)throw InvalidParams("Invalid tx, [to] and [data] can't be omit at the same time");if(chainId||(chainId=network.chainId),"0x"===data&&(data=void 0),gasPrice||(gasPrice="0x1"),value||(value="0x0"),epochHeight||(epochHeight=await cfx_epochNumber(["latest_state"])),nonce||(nonce=await cfx_getNextNonce([from,epoch])),!to||gas&&storageLimit){if(!gas||!storageLimit){var _await$cfx_estimateGa=await cfx_estimateGasAndCollateral([newTx,epoch]),gasLimit=_await$cfx_estimateGa.gasLimit,storageCollateralized=_await$cfx_estimateGa.storageCollateralized;gas||(gas=gasLimit),storageLimit||(storageLimit=storageCollateralized)}}else"contract"===(await wallet_detectAddressType({address:to})).type||data||(gas||(gas="0x5280"),storageLimit||(storageLimit="0x0"));var pk=await wallet_getAddressPrivateKey({addressId:fromAddr.eid});return newTx={from:from,data:data,to:to,gas:gas,gasPrice:gasPrice,nonce:nonce,value:value,chainId:chainId,storageLimit:storageLimit,epochHeight:epochHeight},Object(_fluent_wallet_signature__WEBPACK_IMPORTED_MODULE_1__.a)(newTx,pk,network.netId)}},250:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="eth_requestAccounts",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["inpage"],methods:["wallet_requestPermissions"],db:["getOneApp","accountAddrByNetwork"],scope:null},main=async function(_ref){var _ref$db=_ref.db,getOneApp=_ref$db.getOneApp,accountAddrByNetwork=_ref$db.accountAddrByNetwork,wallet_requestPermissions=_ref.rpcs.wallet_requestPermissions,site=_ref.site,app=_ref.app;if(null!=app&&app.currentAccount)return accountAddrByNetwork({account:app.currentAccount.eid,network:app.currentNetwork.eid}).hex;var permsRes=await wallet_requestPermissions([{eth_accounts:{}}]);if(null==permsRes||!permsRes.error){var _app=getOneApp({site:site.eid}),currentAccount=_app.currentAccount,currentNetwork=_app.currentNetwork;return accountAddrByNetwork({account:currentAccount.eid,network:currentNetwork.eid}).hex}return permsRes}},251:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_wallet_add_network__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(252);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_addEthereumChain",PublicSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_wallet_add_network__WEBPACK_IMPORTED_MODULE_1__.ChainParameterSchema],InnerSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["authReqId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["newChainConfig",PublicSchema]],schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,PublicSchema,InnerSchema]},permissions={external:["inpage","popup"],methods:["wallet_detectNetworkType","wallet_addNetwork","wallet_addPendingUserAuthRequest","wallet_userApprovedAuthRequest","wallet_userRejectedAuthRequest"],db:["getNetwork","getAuthReqById","getNetworkByEndpoint"],scope:{wallet_networks:{}}},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAuthReqById=_ref$db.getAuthReqById,getNetworkByEndpoint=_ref$db.getNetworkByEndpoint,getNetwork=_ref$db.getNetwork,_ref$rpcs=_ref.rpcs,wallet_detectNetworkType=_ref$rpcs.wallet_detectNetworkType,wallet_addNetwork=_ref$rpcs.wallet_addNetwork,wallet_addPendingUserAuthRequest=_ref$rpcs.wallet_addPendingUserAuthRequest,wallet_userApprovedAuthRequest=_ref$rpcs.wallet_userApprovedAuthRequest,wallet_userRejectedAuthRequest=_ref$rpcs.wallet_userRejectedAuthRequest,app=_ref.app,params=_ref.params,_popup=_ref._popup,_inpage=_ref._inpage,chainConf=Array.isArray(params)?params[0]:params.newChainConfig[0],chainId=chainConf.chainId,rpcUrl=_slicedToArray(chainConf.rpcUrls,1)[0],dupEndpointNetwork=_slicedToArray(getNetworkByEndpoint(rpcUrl),1)[0];if(dupEndpointNetwork)throw InvalidParams(`Duplicate network endpoint with network ${dupEndpointNetwork.eid}`);var _await$wallet_detectN=await wallet_detectNetworkType({url:rpcUrl}),detectedChainId=_await$wallet_detectN.chainId,detectedNetworkType=_await$wallet_detectN.type;if(chainId!==detectedChainId)throw InvalidParams(`Invalid chainId ${chainId}, got ${detectedChainId} from remote`);if(_slicedToArray(getNetwork({chainId:chainId,builtin:!0,type:detectedNetworkType}),1)[0])throw InvalidParams(`Duplicate chainId ${chainId} with builtin network`);if(_inpage){var req={method:NAME,params:params};return await wallet_addPendingUserAuthRequest({appId:app.eid,req:req})}if(_popup){var authReqId=params.authReqId;if(!authReqId)throw InvalidParams(`Invalid auth req id ${authReqId}`);if(!getAuthReqById(authReqId))throw InvalidParams(`Invalid auth req id ${authReqId}`);var rst=await wallet_addNetwork(chainConf);return null!=rst&&rst.error?await wallet_userRejectedAuthRequest({authReqId:authReqId}):await wallet_userApprovedAuthRequest({authReqId:authReqId,res:"__null__"})}}},252:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"ChainParameterSchema",(function(){return ChainParameterSchema})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1165);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_addNetwork",nativeCurrencySchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0,doc:"Config of the native currency of the chain"},["name",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp],["symbol",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.tokenSymbol],["decimals",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.eq,18]]],ChainParameterSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0,doc:"Config of the chain to add, check it at https://docs.metamask.io/guide/rpc-api.html#wallet-addethereumchain"},["chainId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.chainId],["chainName",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp],["nativeCurrency",nativeCurrencySchema],["rpcUrls",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.plus,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.url]],["blockExplorerUrls",{optional:!0},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.plus,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.url]],["iconUrls",{optional:!0},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.plus,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.url]],["hdPath",{optional:!0,doc:'the hd path of this netowrk, default to the detected network type (cfx/eth), can be one of hd path dbid, hd path type "cfx"/"eth" or hd path value'},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.enums,"cfx","eth"],_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.hdPath]]],schemas={input:ChainParameterSchema},permissions={external:["popup"],db:["t","getNetwork","getHdPathById","getNetworkByName","getNetworkByEndpoint","getOneHdPath","filterAccountGroupByNetworkType"],methods:["wallet_addHdPath","wallet_detectNetworkType","wallet_discoverAccounts","wallet_createAddress"]},main=async function(_ref){var _getOneHdPath,InvalidParams=_ref.Err.InvalidParams,_ref$rpcs=_ref.rpcs,wallet_addHdPath=_ref$rpcs.wallet_addHdPath,wallet_detectNetworkType=_ref$rpcs.wallet_detectNetworkType,wallet_discoverAccounts=_ref$rpcs.wallet_discoverAccounts,wallet_createAddress=_ref$rpcs.wallet_createAddress,_ref$db=_ref.db,t=_ref$db.t,getHdPathById=_ref$db.getHdPathById,getNetwork=_ref$db.getNetwork,getNetworkByName=_ref$db.getNetworkByName,getNetworkByEndpoint=_ref$db.getNetworkByEndpoint,getOneHdPath=_ref$db.getOneHdPath,filterAccountGroupByNetworkType=_ref$db.filterAccountGroupByNetworkType,_ref$params=_ref.params,chainId=_ref$params.chainId,name=_ref$params.chainName,ticker=_ref$params.nativeCurrency,rpcUrls=_ref$params.rpcUrls,_ref$params$blockExpl=_ref$params.blockExplorerUrls,blockExplorerUrls=void 0===_ref$params$blockExpl?[]:_ref$params$blockExpl,_ref$params$iconUrls=_ref$params.iconUrls,iconUrls=void 0===_ref$params$iconUrls?[]:_ref$params$iconUrls,hdPath=_ref$params.hdPath,url=_slicedToArray(rpcUrls,1)[0],explorerUrl=_slicedToArray(blockExplorerUrls,1)[0],iconUrl=_slicedToArray(iconUrls,1)[0];if(_slicedToArray(getNetworkByName(name),1)[0])throw InvalidParams("Duplicate network name");var dupEndpointNetwork=_slicedToArray(getNetworkByEndpoint(url),1)[0];if(dupEndpointNetwork)throw InvalidParams(`Duplicate network endpoint with network ${dupEndpointNetwork.eid}`);if(Number.isInteger(hdPath)&&!getHdPathById(hdPath))throw InvalidParams(`Invalid hdPath id ${hdPath}`);if(_slicedToArray(getNetwork({chainId:chainId,builtin:!0}),1)[0])throw InvalidParams(`Duplicate chainId ${chainId} with builtin network`);var _await$wallet_detectN=await wallet_detectNetworkType({url:url}),networkType=_await$wallet_detectN.type,detectedChainId=_await$wallet_detectN.chainId,netId=_await$wallet_detectN.netId;if(chainId!==detectedChainId)throw InvalidParams(`Invalid chainId ${chainId}, got ${detectedChainId} from remote`);hdPath=hdPath||networkType;var hdPathId=Number.isInteger(hdPath)&&getHdPathById(hdPath).eid||"cfx"===hdPath&&getOneHdPath({value:_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_1__.c}).eid||"eth"===hdPath&&getOneHdPath({value:_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_1__.d}).eid||(null===(_getOneHdPath=getOneHdPath({value:hdPath}))||void 0===_getOneHdPath?void 0:_getOneHdPath.eid)||"newHdPath";"newHdPath"===hdPathId&&(hdPathId=await wallet_addHdPath({name:`${name}-hdPath`,value:hdPath}));var networkId=t([{eid:"networkId",network:{name:name,endpoint:url,type:networkType,hdPath:hdPathId,chainId:chainId,netId:parseInt(netId,10),ticker:ticker,builtin:!1}},explorerUrl&&{eid:"networkId",network:{scanUrl:explorerUrl}},iconUrl&&{eid:"networkId",network:{icon:iconUrl}}]).tempids.networkId,groups=filterAccountGroupByNetworkType(networkType);return await Promise.all(groups.map((function(_ref2){var eid=_ref2.eid;return wallet_createAddress({accountGroupId:eid,networkId:networkId})}))),await Promise.all(groups.filter((function(_ref3){return"hd"===_ref3.vault.type})).map((function(_ref4){var eid=_ref4.eid;return wallet_discoverAccounts({accountGroupId:eid})}))),networkId}},254:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_cfx_request_accounts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(248),NAME="cfx_accounts",schemas=_fluent_wallet_cfx_request_accounts__WEBPACK_IMPORTED_MODULE_0__.schemas,permissions=_fluent_wallet_cfx_request_accounts__WEBPACK_IMPORTED_MODULE_0__.permissions,main=_fluent_wallet_cfx_request_accounts__WEBPACK_IMPORTED_MODULE_0__.main},255:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_call",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["from",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress],["to",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32ContractAddress],["gasPrice",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["gas",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["value",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["data",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Bytes],["nonce",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint]],_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochRef]},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},256:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_chainId",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup","inpage"],locked:!0,methods:["cfx_getStatus"]},cache={type:"ttl",ttl:864e5,key:function(){return NAME},afterGet:function(_,c){if(!c)return"nocache"}},main=async function(_ref){var _await$cfx_getStatus,f=_ref.f,cfx_getStatus=_ref.rpcs.cfx_getStatus,rst=await f();return"nocache"===(null==rst?void 0:rst.result)?null===(_await$cfx_getStatus=await cfx_getStatus())||void 0===_await$cfx_getStatus?void 0:_await$cfx_getStatus.chainId:rst.result}},257:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_epochNumber",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.zeroOrOne,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochTag],_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nul]},permissions={locked:!0,external:["popup","inpage"]},cache={type:"ttl",ttl:500,key:function(_ref){return`EPOCH${_ref.params[0]}`}},main=async function(_ref2){var f=_ref2.f,params=_ref2.params;return await f(params)}},258:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_estimateGasAndCollateral",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["from",{optional:!0,doc:"default to random address"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress],["to",{optional:!0,doc:"default to null for contract crateion"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32Address],["gas",{optional:!0,doc:"default to 0x1dcd6500(500000000)"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["gasPrice",{optional:!0,doc:"default to 0x0"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["value",{optional:!0,doc:"default to 0x0"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["data",{optional:!0,doc:"default to 0x"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Bytes],["nonce",{optional:!0,doc:"default to 0x0"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["storageLimit",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint],["epochHeight",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Uint]],[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.zeroOrOne,{doc:"default to latest_state"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochRef]]},cache={type:"epoch",key:function(_ref){var params=_ref.params;return`${NAME}${JSON.stringify(params[0])}`}},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref2){var f=_ref2.f,params=_ref2.params;return await f(params)}},259:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_gasPrice",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nul]},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref){var f=_ref.f;return await f()}},260:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_getAccount",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32Address,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.zeroOrOne,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochRef]]},cache={type:"epoch",key:function(_ref){var params=_ref.params;return`${NAME}${params[0]}`}},permissions={locked:!0,external:["popup","inpage"]},main=async function(_ref2){var f=_ref2.f,params=_ref2.params;return await f(params)}},261:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_getBalance",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32Address,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochRef]},permissions={locked:!0,external:["popup","inpage"]},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},262:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_getCode",cache={type:"epoch",ttl:3600,key:function(_ref){var params=_ref.params;return`${NAME}${params[0]}`}},schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32ContractAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochRef]},permissions={locked:!0,external:["popup","inpage"]},main=async function(_ref2){var f=_ref2.f,params=_ref2.params;return await f(params)}},263:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_getNextNonce",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.epochRef]},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},264:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_getStatus",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nul]},chainIdCacheConf={type:"ttl",ttl:864e5,key:"cfx_chainId"},networkIdCacheConf={type:"ttl",ttl:864e5,key:"cfx_netVersion"},cache={type:"ttl",ttl:500,key:function(){return`${NAME}`},afterSet:function(setCache,req,res){setCache({req:req,res:{result:res.result.chainId},chainIdCacheConf:chainIdCacheConf}),setCache({req:req,res:{result:res.result.networkId},networkIdCacheConf:networkIdCacheConf})}},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref){var f=_ref.f;return await f()}},265:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_netVersion",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup","inpage"],locked:!0,methods:["cfx_getStatus"]},cache={type:"ttl",ttl:864e5,key:function(){return NAME},afterGet:function(_,c){if(!c)return"nocache"}},main=async function(_ref){var _await$cfx_getStatus,f=_ref.f,cfx_getStatus=_ref.rpcs.cfx_getStatus,rst=await f();return"nocache"===(null==rst?void 0:rst.result)?parseInt(null===(_await$cfx_getStatus=await cfx_getStatus())||void 0===_await$cfx_getStatus?void 0:_await$cfx_getStatus.networkId,16).toString():parseInt(rst.result,16).toString()}},266:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="cfx_sendRawTransaction",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.Bytes]},permissions={external:[],methods:[],db:[]},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},267:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_cfx_sign_transaction__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(249);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="cfx_sendTransaction",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_cfx_sign_transaction__WEBPACK_IMPORTED_MODULE_1__.schemas.input,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["authReqId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["tx",_fluent_wallet_cfx_sign_transaction__WEBPACK_IMPORTED_MODULE_1__.schemas.input]]]},permissions={external:["popup","inpage"],methods:["cfx_signTransaction","cfx_sendRawTransaction","wallet_addPendingUserAuthRequest","wallet_userApprovedAuthRequest"],db:["getFromAddress"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,getFromAddress=_ref.db.getFromAddress,_ref$rpcs=_ref.rpcs,cfx_signTransaction=_ref$rpcs.cfx_signTransaction,cfx_sendRawTransaction=_ref$rpcs.cfx_sendRawTransaction,wallet_addPendingUserAuthRequest=_ref$rpcs.wallet_addPendingUserAuthRequest,wallet_userApprovedAuthRequest=_ref$rpcs.wallet_userApprovedAuthRequest,params=_ref.params,_inpage=_ref._inpage,app=_ref.app,network=_ref.network;if(_inpage){if(params.authReqId)throw InvalidParams("Invalid tx data");var from=_slicedToArray(params,1)[0].from;if(!getFromAddress({networkId:network.eid,address:from,appId:app.eid}))throw InvalidParams(`Invalid from address in tx ${from}`);return await cfx_signTransaction(params),await wallet_addPendingUserAuthRequest({appId:app.eid,req:{method:NAME,params:params}})}var tx=params.authReqId?params.tx:params,rawtx=await cfx_signTransaction(tx),rst=await cfx_sendRawTransaction([rawtx]);return params.authReqId?await wallet_userApprovedAuthRequest({authReqId:params.authReqId,res:rst}):rst}},268:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_eth_request_accounts__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(250),NAME="eth_accounts",schemas=_fluent_wallet_eth_request_accounts__WEBPACK_IMPORTED_MODULE_0__.schemas,permissions=_fluent_wallet_eth_request_accounts__WEBPACK_IMPORTED_MODULE_0__.permissions,main=_fluent_wallet_eth_request_accounts__WEBPACK_IMPORTED_MODULE_0__.main},269:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="eth_blockNumber",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.and,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.arrp,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.empty]},permissions={locked:!0,external:["popup","inpage"]},cache={type:"ttl",ttl:1e4},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},270:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_eth_transaction_schema__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1225),_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1143),TxMapSpecs=Object(_fluent_wallet_eth_transaction_schema__WEBPACK_IMPORTED_MODULE_0__.a)(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__).TxMapSpecs,NAME="eth_call",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.cat,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.map,{closed:!0},Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.optionalMapKey)(TxMapSpecs.from),TxMapSpecs.to,Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.optionalMapKey)(TxMapSpecs.gasPrice),Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.optionalMapKey)(TxMapSpecs.gas),Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.optionalMapKey)(TxMapSpecs.nonce),Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.optionalMapKey)(TxMapSpecs.value),Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.optionalMapKey)(TxMapSpecs.data)],_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.blockRef]},permissions={external:["popup","inpage"],locked:!0,methods:[],db:[]},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},271:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="eth_chainId",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.and,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.arrp,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.empty]},permissions={external:["popup","inpage"],locked:!0},cache={type:"ttl",ttl:864e5,key:function(){return NAME}},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},272:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_eth_transaction_schema__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1225),TransactionLegacyUnsigned=Object(_fluent_wallet_eth_transaction_schema__WEBPACK_IMPORTED_MODULE_1__.a)(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__).TransactionLegacyUnsigned,NAME="eth_estimateGas",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,TransactionLegacyUnsigned.map((function(k){return Array.isArray(k)?_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optionalMapKey(k):k}))]},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},273:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="eth_gasPrice",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.and,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.arrp,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.empty]},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},274:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="eth_getBalance",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.blockRef]},permissions={locked:!0,external:["popup","inpage"]},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},275:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="eth_getCode",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.blockTag]},cache={type:"block",ttl:3600,key:function(_ref){var params=_ref.params;return`${NAME}${params[0]}`}},permissions={locked:!0,external:["popup","inpage"]},main=async function(_ref2){var f=_ref2.f,params=_ref2.params;return await f(params)}},276:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="eth_getTransactionCount",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.blockTag]},permissions={locked:!0,external:["popup","inpage"]},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},277:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_cfx_sign_typed_data_v4__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(244);__webpack_require__.d(__webpack_exports__,"permissions",(function(){return _fluent_wallet_cfx_sign_typed_data_v4__WEBPACK_IMPORTED_MODULE_0__.permissions}));var NAME="eth_signTypedData_v4",schemas=_fluent_wallet_cfx_sign_typed_data_v4__WEBPACK_IMPORTED_MODULE_0__.gen.schemas("eth"),main=_fluent_wallet_cfx_sign_typed_data_v4__WEBPACK_IMPORTED_MODULE_0__.gen.main("eth")},278:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"cache",(function(){return cache})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="net_version",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.and,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.arrp,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.empty]},permissions={external:["popup","inpage"],locked:!0},cache={type:"ttl",ttl:864e5,key:function(){return NAME}},main=async function(_ref){var f=_ref.f,params=_ref.params;return await f(params)}},279:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_signature__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1181),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1147);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="personal_sign",publicSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp,{doc:"message string to sign"}],[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress]],innerSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["authReqId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["data",publicSchema]],schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,innerSchema,publicSchema]},permissions={external:["inpage","popup"],methods:["wallet_addPendingUserAuthRequest","wallet_userApprovedAuthRequest","wallet_userRejectedAuthRequest","wallet_getAddressPrivateKey"],db:["getAuthReqById","accountAddrByNetwork"],scope:{wallet_accounts:{}}},main=async function(_ref){var _ref$Err=_ref.Err,InvalidParams=_ref$Err.InvalidParams,Unauthorized=_ref$Err.Unauthorized,UserRejected=_ref$Err.UserRejected,_ref$db=_ref.db,getAuthReqById=_ref$db.getAuthReqById,accountAddrByNetwork=_ref$db.accountAddrByNetwork,_ref$rpcs=_ref.rpcs,wallet_getAddressPrivateKey=_ref$rpcs.wallet_getAddressPrivateKey,wallet_userApprovedAuthRequest=_ref$rpcs.wallet_userApprovedAuthRequest,wallet_userRejectedAuthRequest=_ref$rpcs.wallet_userRejectedAuthRequest,wallet_addPendingUserAuthRequest=_ref$rpcs.wallet_addPendingUserAuthRequest,params=_ref.params,_inpage=_ref._inpage,_popup=_ref._popup,app=_ref.app;if(_inpage){var type=app.currentNetwork.type,from=_slicedToArray(params,2)[1];if("cfx"===type&&!Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.validate)(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress,from,{netId:app.currentNetwork.netId}))throw InvalidParams(`Invalid from ${from} for the target network ${app.currentNetwork.name}`);var addr=accountAddrByNetwork({account:app.currentAccount.eid,network:app.currentNetwork.eid});if("cfx"===type&&Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__.a)(from).hexAddress!==addr.cfxHex.toLowerCase())throw Unauthorized();if("eth"===type&&from!==addr.hex)throw Unauthorized();if("pub"===addr.vault.type)throw UserRejected();var req={method:NAME,params:params};return await wallet_addPendingUserAuthRequest({appId:app.eid,req:req})}if(_popup){var authReqId=params.authReqId,_params$data=_slicedToArray(params.data,2),message=_params$data[0],_from=_params$data[1],authReq=getAuthReqById(authReqId);if(!authReq)throw InvalidParams(`Invalid auth req id ${authReqId}`);var _type=authReq.app.currentNetwork.type,_addr=accountAddrByNetwork({account:authReq.app.currentAccount.eid,network:authReq.app.currentNetwork.eid});if("cfx"===_type&&!Object(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.validate)(_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress,_from,{netId:authReq.app.currentNetwork.netId}))throw InvalidParams(`Invalid from ${_from} for the target network ${authReq.app.currentNetwork.name}`);if("pub"===_addr.vault.type)return wallet_userRejectedAuthRequest({authReqId:authReqId});if("cfx"===_type&&Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__.a)(_from).hexAddress!==_addr.cfxHex.toLowerCase())return wallet_userRejectedAuthRequest({authReqId:authReqId});if("eth"===_type&&_from.toLowerCase()!==_addr.hex.toLowerCase())return wallet_userRejectedAuthRequest({authReqId:authReqId});var pk=_addr.pk||await wallet_getAddressPrivateKey({addressId:_addr.eid}),sig=await Object(_fluent_wallet_signature__WEBPACK_IMPORTED_MODULE_1__.c)(_type,pk,message);return await wallet_userApprovedAuthRequest({authReqId:authReqId,res:sig})}}},280:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_wallet_add_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(251),NAME="wallet_addConfluxChain",schemas=_fluent_wallet_wallet_add_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__.schemas,permissions=_fluent_wallet_wallet_add_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__.permissions,main=_fluent_wallet_wallet_add_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__.main},281:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_addHdPath",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["hdPath",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.hdPath],["name",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp,{min:2,max:128}]]]},permissions={external:["popup"],db:["getHdPathByName","getHdPathByValue","t"]},main=function(_ref){var _ref$Err=_ref.Err,InvalidParams=_ref$Err.InvalidParams,t=_ref$Err.t,_ref$db=_ref.db,getHdPathByName=_ref$db.getHdPathByName,getHdPathByValue=_ref$db.getHdPathByValue,_ref$params=_ref.params,name=_ref$params.name,hdPath=_ref$params.hdPath;if(getHdPathByName(name).length)throw InvalidParams("Duplicate hd path name");var dup=_slicedToArray(getHdPathByValue(hdPath),1)[0];if(dup)throw InvalidParams(`hd path already added with name ${dup.name}`);return t({eid:"newHdPathId",hdPath:{value:hdPath,name:name}}).tempids.newHdPathId}},282:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_csp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1226),NAME="wallet_addPendingUserAuthRequest",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["req",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.mapp],["siteId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]],[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["req",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.mapp],["appId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]]},permissions={methods:["wallet_userRejectedAuthRequest"],db:["t","getSiteById","getAppById","getAuthReqById"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,t=_ref$db.t,getSiteById=_ref$db.getSiteById,getAppById=_ref$db.getAppById,getAuthReqById=_ref$db.getAuthReqById,wallet_userRejectedAuthRequest=_ref.rpcs.wallet_userRejectedAuthRequest,MODE=_ref.MODE,_ref$params=_ref.params,_ref$params$req=_ref$params.req,method=_ref$params$req.method,params=_ref$params$req.params,siteId=_ref$params.siteId,appId=_ref$params.appId,site=getSiteById(siteId),app=getAppById(appId);if(siteId&&!site)throw InvalidParams(`Invalid site id ${siteId}`);if(appId&&!app)throw InvalidParams(`Invalid app id ${appId}`);var c=Object(_fluent_wallet_csp__WEBPACK_IMPORTED_MODULE_1__.a)(1),authReqId=t([site&&{eid:"authReqId",authReq:{site:site.eid,req:{method:method,params:params},c:c}},app&&{eid:"authReqId",authReq:{app:app.eid,req:{method:method,params:params},c:c}}]).tempids.authReqId,popup=(await Promise.all([__webpack_require__.e(0),__webpack_require__.e(1)]).then(__webpack_require__.bind(null,1169))).popup,w=await popup.show({alwaysOnTop:!!MODE.isProd,mode:MODE});MODE.isProd&&popup.onFocusChanged(w.id,popup.remove),popup.onRemoved(null==w?void 0:w.id,(function(){return getAuthReqById(authReqId)&&wallet_userRejectedAuthRequest({errorFallThrough:!0},{authReqId:authReqId})}));var rst=await c.read();if(rst instanceof Error)throw rst;return rst}},283:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"newAccounts",(function(){return newAccounts})),__webpack_require__.d(__webpack_exports__,"newAccountGroup",(function(){return newAccountGroup})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149),_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1167),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1147),_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1153),_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1158);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_addVault",baseInputSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["nickname",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nickname]],menomicSchema=[].concat(baseInputSchema,[["mnemonic",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.mnemonic],["waitTillFinish",{optional:!0},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.maybe,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]],["cfxOnly",{optional:!0,doc:"only derive conflux compatible address from this mnemonic"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep],["force",{optional:!0,doc:"set to true to skip duplication check"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]]),privateKeySchema=[].concat(baseInputSchema,[["privateKey",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.privateKey]]),addressSchema=[].concat(baseInputSchema,[["address",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress]]]),schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,menomicSchema,privateKeySchema,addressSchema]},permissions={methods:["wallet_unlock","wallet_discoverAccounts","wallet_getBalance","wallet_getNextNonce","wallet_validatePassword","wallet_deleteAccountGroup","wallet_refetchTokenList"],db:["t","getOneAccount","getAccount","getVault","getVaultById","createVault","getAccountGroup","getNetwork","getOneAccountByGroupAndIndex","getLocked","getPassword"]};async function newAccounts(arg){var groupId=arg.groupId,groupName=arg.groupName,wallet_discoverAccounts=arg.rpcs.wallet_discoverAccounts,vault=arg.vault,_arg$db=arg.db,getNetwork=_arg$db.getNetwork,t=_arg$db.t,getOneAccountByGroupAndIndex=_arg$db.getOneAccountByGroupAndIndex;"hd"!==vault.type?getNetwork().forEach((function(_ref2){var _account$eid3,_account$eid4,eid=_ref2.eid,netId=_ref2.netId,type=_ref2.type,account=getOneAccountByGroupAndIndex({index:0,groupId:groupId});if("pk"!==vault.type)vault.cfxOnly&&"cfx"!==type||t([{eid:-1,address:{hex:vault.ddata,vault:vault.eid}},"cfx"===type&&{eid:-1,address:{base32:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_3__.b)(Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_4__.f)(vault.ddata),netId),cfxHex:Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_4__.f)(vault.ddata)}},{eid:eid,network:{address:-1}},{eid:null!==(_account$eid3=null==account?void 0:account.eid)&&void 0!==_account$eid3?_account$eid3:-2,account:{index:0,nickname:`${groupName}-1`,address:-1,hidden:!1}},{eid:groupId,accountGroup:{account:null!==(_account$eid4=null==account?void 0:account.eid)&&void 0!==_account$eid4?_account$eid4:-2}}]);else{var _account$eid,_account$eid2,addr=Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_4__.a)(vault.ddata).address;t([{eid:-1,address:{hex:addr,pk:vault.ddata,vault:vault.eid}},"cfx"===type&&{eid:-1,address:{cfxHex:Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_4__.f)(addr),base32:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_3__.b)(Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_4__.f)(addr),netId)}},{eid:eid,network:{address:-1}},{eid:null!==(_account$eid=null==account?void 0:account.eid)&&void 0!==_account$eid?_account$eid:-2,account:{address:-1,index:0,nickname:`${groupName}-1`,hidden:!1}},{eid:groupId,accountGroup:{account:null!==(_account$eid2=null==account?void 0:account.eid)&&void 0!==_account$eid2?_account$eid2:-2}}])}})):await wallet_discoverAccounts({accountGroupId:groupId,limit:10,waitTillFinish:!0})}async function newAccountGroup(arg){var _arg$params=arg.params,waitTillFinish=_arg$params.waitTillFinish,nickname=_arg$params.nickname,_arg$db2=arg.db,getAccountGroup=_arg$db2.getAccountGroup,getVaultById=_arg$db2.getVaultById,t=_arg$db2.t,vaultId=arg.vaultId,groups=getAccountGroup(),vault=getVaultById(vaultId),groupName=nickname||`Seed-${groups.length+1}`,groupId=t([{eid:-1,accountGroup:{nickname:groupName,vault:vaultId,hidden:!1}}]).tempids[-1],newAccountsPromise=newAccounts(Object.assign({},arg,{vault:vault,groupId:groupId,groupName:groupName})).then((function(){!function setDefaultSelectedAccount(_ref){var _ref$db=_ref.db,getOneAccount=_ref$db.getOneAccount,getAccount=_ref$db.getAccount,t=_ref$db.t;if(!getOneAccount({selected:!0})){var defaultSelectedAccount=getAccount()[0];defaultSelectedAccount&&t([{eid:defaultSelectedAccount.eid,account:{selected:!0}}])}}(arg)}));return waitTillFinish&&await newAccountsPromise,groupId}var main=async function(arg){var _getAccountGroup,_arg$db3=arg.db,createVault=_arg$db3.createVault,getVault=_arg$db3.getVault,getAccountGroup=_arg$db3.getAccountGroup,getVaultById=_arg$db3.getVaultById,getPassword=_arg$db3.getPassword,getLocked=_arg$db3.getLocked,_arg$rpcs=arg.rpcs,wallet_validatePassword=_arg$rpcs.wallet_validatePassword,wallet_deleteAccountGroup=_arg$rpcs.wallet_deleteAccountGroup,wallet_unlock=_arg$rpcs.wallet_unlock,wallet_refetchTokenList=_arg$rpcs.wallet_refetchTokenList,_arg$params2=arg.params,optionalPassword=_arg$params2.password,mnemonic=_arg$params2.mnemonic,privateKey=_arg$params2.privateKey,address=_arg$params2.address,cfxOnly=_arg$params2.cfxOnly,force=_arg$params2.force,InvalidParams=arg.Err.InvalidParams,isFirstGroup=!(null!==(_getAccountGroup=getAccountGroup())&&void 0!==_getAccountGroup&&_getAccountGroup.length),isLocked=getLocked(),password=optionalPassword;if(isLocked&&isFirstGroup&&!password)throw InvalidParams("Invalid password");if(isFirstGroup||password||(password=getPassword()),!await wallet_validatePassword({password:password}))throw InvalidParams("Invalid password");var vault={cfxOnly:!1};if(vault.data=mnemonic||privateKey||address,privateKey)vault.type="pk",vault.data=Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_5__.c)(privateKey);else if(mnemonic)vault.type="hd",cfxOnly&&(vault.cfxOnly=!0);else if(address){var validateResult=function(address){return Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_3__.d)(address)?{cfxOnly:!0,address:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_3__.a)(address).hexAddress.toString("hex")}:{address:address,cfxOnly:!1}}(address);vault.type="pub",vault.data=validateResult.address,vault.cfxOnly=validateResult.cfxOnly}var vaults=getVault(),anyDuplicateVaults=(await Promise.all(vaults.map(Object(_fluent_wallet_compose__WEBPACK_IMPORTED_MODULE_2__.a)((async function(v){return[v.ddata||await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(password,v.data),v.eid]}),(function(p){return p.then((function(_ref3){var _ref4=_slicedToArray(_ref3,2),ddata=_ref4[0],eid=_ref4[1];return ddata===vault.data?eid:null}))}))))).filter((function(v){return Boolean(v)}));if(anyDuplicateVaults.length){var err,duplicateVaultId=_slicedToArray(anyDuplicateVaults,1)[0],duplicateAccountGroup=_slicedToArray(getAccountGroup({vault:duplicateVaultId}),1)[0],duplicateVault=getVaultById(duplicateVaultId);if(!force)throw"hd"===vault.type&&duplicateVault.cfxOnly!==vault.cfxOnly?(err=InvalidParams(`Duplicate credential(with different cfxOnly setting) with account group ${duplicateAccountGroup.eid}`)).extra.updateCfxOnly=!0:err=InvalidParams(`Duplicate credential with account group ${duplicateAccountGroup.eid}`),err.extra.duplicateAccountGroupId=duplicateAccountGroup.eid,err;if("hd"!==duplicateVault.type)throw InvalidParams("Can't force import none hd vault");await wallet_deleteAccountGroup({accountGroupId:duplicateAccountGroup.eid,password:password})}vault.ddata=vault.data,vault.data=await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.encrypt)(password,vault.data);var vaultId=createVault(vault);return isFirstGroup?await wallet_unlock({password:password,waitSideEffects:!0}):await wallet_refetchTokenList(),newAccountGroup(Object.assign({},arg,{vaultId:vaultId}))}},284:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149),_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1160),_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1153),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1147),NAME="wallet_createAccount",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountGroupId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["nickname",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nickname]]},permissions={db:["getNetwork","getPassword","getAccountGroupById","getOneAccountByGroupAndIndex","t"],external:["popup"]},main=async function(_ref){var _vault$ddata,_ref$db=_ref.db,getPassword=_ref$db.getPassword,getNetwork=_ref$db.getNetwork,getOneAccountByGroupAndIndex=_ref$db.getOneAccountByGroupAndIndex,t=_ref$db.t,getAccountGroupById=_ref$db.getAccountGroupById,_ref$params=_ref.params,accountGroupId=_ref$params.accountGroupId,nickname=_ref$params.nickname,InvalidParams=_ref.Err.InvalidParams,group=getAccountGroupById(accountGroupId);if(!group)throw InvalidParams("Invalid account group id");var vault=group.vault;if("hd"!==vault.type)throw InvalidParams("Can't add account into none hd vault");var existAccounts=group.account||[],nextAccountIdx=existAccounts.length;if(existAccounts.reduce((function(acc,account){return acc||account.nickname===nickname}),!1))throw InvalidParams(`Invalid nickname "${nickname}", duplicate with other account in the same account group`);var password=getPassword(),decrypted=null!==(_vault$ddata=vault.ddata)&&void 0!==_vault$ddata?_vault$ddata:await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(password,vault.data),networks=getNetwork();return(await Promise.all(networks.map((async function(_ref2){var eid=_ref2.eid,hdPath=_ref2.hdPath;return{eid:eid,netId:_ref2.netId,type:_ref2.type,addr:await Object(_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_2__.a)({mnemonic:decrypted,hdPath:hdPath.value,nth:nextAccountIdx,only0x1Prefixed:vault.cfxOnly})}}))).then((function(params){return params.map((function(_ref3){var _getOneAccountByGroup,_tempids$accountId,eid=_ref3.eid,netId=_ref3.netId,type=_ref3.type,_ref3$addr=_ref3.addr,address=_ref3$addr.address,index=_ref3$addr.index,privateKey=_ref3$addr.privateKey,accountId=(null===(_getOneAccountByGroup=getOneAccountByGroupAndIndex({index:nextAccountIdx,groupId:accountGroupId}))||void 0===_getOneAccountByGroup?void 0:_getOneAccountByGroup.eid)||"accountId";return accountId=null!==(_tempids$accountId=t([{eid:-1,address:{vault:vault.eid,index:index,hex:address,pk:privateKey}},"cfx"===type&&{eid:-1,address:{cfxHex:Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(address),base32:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_4__.b)(Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(address),netId)}},{eid:eid,network:{address:-1}},{eid:accountId,account:{index:nextAccountIdx,nickname:null!=nickname?nickname:`${group.nickname}-${nextAccountIdx+1}`,address:-1,hidden:!1}},{eid:accountGroupId,accountGroup:{account:accountId}}]).tempids.accountId)&&void 0!==_tempids$accountId?_tempids$accountId:accountId}))})))[0]}},285:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1160),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1147),_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1153),browser_passworder__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1149),NAME="wallet_createAddress",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountGroupId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["networkId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={methods:[],db:["getPassword","getAccountGroupById","getNetworkById","t"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getNetworkById=_ref$db.getNetworkById,getAccountGroupById=_ref$db.getAccountGroupById,getPassword=_ref$db.getPassword,t=_ref$db.t,_ref$params=_ref.params,networkId=_ref$params.networkId,accountGroupId=_ref$params.accountGroupId,network=getNetworkById(networkId);if(!network)throw InvalidParams(`Invalid network id ${networkId}`);var group=getAccountGroupById(accountGroupId);if(!group)throw InvalidParams(`Invalid account group id ${accountGroupId}`);var vault=group.vault;if("pub"===vault.type&&vault.cfxOnly&&"cfx"!==network.type)throw InvalidParams("Can't create address for cfx only vault in eth network");var pwd=getPassword(),decrypted=vault.ddata||await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_4__.decrypt)(pwd,vault.data);if("pub"===vault.type)return[t([{eid:"newAddr",address:{vault:vault.eid,index:0,hex:decrypted}},"cfx"===network.type&&{eid:"newAddr",address:{cfxHex:Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(decrypted),base32:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__.b)(Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(decrypted),network.netId)}},{eid:group.account[0].eid,account:{address:"newAddr"}},{eid:network.eid,network:{address:"newAddr"}}]).tempids.newAddr];if("pk"===vault.type){var hex=Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.a)(decrypted);return[t([{eid:"newAddr",address:{vault:vault.eid,index:0,hex:hex}},"cfx"===network.type&&{eid:"newAddr",address:{cfxHex:Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(hex),base32:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__.b)(Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(hex),network.netId)}},{eid:group.account[0].eid,account:{address:"newAddr"}},{eid:network.eid,network:{address:"newAddr"}}]).tempids.newAddr]}return await Promise.all(group.account.map((async function(account){return{account:account,addr:await Object(_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_1__.a)({mnemonic:decrypted,hdPath:network.hdPath.value,nth:account.index,only0x1Prefixed:vault.cfxOnly})}}))).then((function(toCreates){return toCreates.map((function(_ref2){var account=_ref2.account,_ref2$addr=_ref2.addr,privateKey=_ref2$addr.privateKey,address=_ref2$addr.address,index=_ref2$addr.index;return t([{eid:"newAddr",address:{vault:vault.eid,index:index,hex:address,pk:privateKey}},"cfx"===network.type&&{eid:"newAddr",address:{cfxHex:Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(address),base32:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__.b)(Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_3__.f)(address),network.netId)}},{eid:account.eid,account:{address:"newAddr"}},{eid:network.eid,network:{address:"newAddr"}}]).tempids.newAddr}))}))}},286:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_dbQuery",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["method",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp],["params",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.mapp]]},permissions={external:["popup"],methods:[],db:[]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,db=_ref.db,_ref$params=_ref.params,method=_ref$params.method,params=_ref$params.params;if(!db[method])throw InvalidParams(`Invalid db query method ${method}`);return db[method](params)}},287:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_deleteAccountGroup",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountGroupId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]]},permissions={db:["getAccountGroupById","deleteVaultById","deleteAccountGroupById"],external:["popup"],methods:["wallet_validatePassword"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,wallet_validatePassword=_ref.rpcs.wallet_validatePassword,_ref$db=_ref.db,getAccountGroupById=_ref$db.getAccountGroupById,deleteVaultById=_ref$db.deleteVaultById,deleteAccountGroupById=_ref$db.deleteAccountGroupById,_ref$params=_ref.params,accountGroupId=_ref$params.accountGroupId,password=_ref$params.password;if(!await wallet_validatePassword({password:password}))throw InvalidParams("Incorrect password");var group=getAccountGroupById(accountGroupId);if(!group)throw InvalidParams(`Invalid account group id ${accountGroupId}`);return deleteVaultById(group.vault.eid),deleteAccountGroupById(group.eid)}},288:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_deleteApp",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["appId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={external:["popup"],methods:[],db:["retract","getAppById"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAppById=_ref$db.getAppById,retract=_ref$db.retract,appId=_ref.params.appId,app=getAppById(appId);if(!app)throw InvalidParams(`Invalid app id ${appId}`);return retract(app.eid),null}},289:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_deleteNetwork",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["networkId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={external:["popup"],db:["deleteNetworkById","getNetworkById"],methods:["wallet_validatePassword"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,deleteNetworkById=_ref$db.deleteNetworkById,getNetworkById=_ref$db.getNetworkById,wallet_validatePassword=_ref.rpcs.wallet_validatePassword,_ref$params=_ref.params,password=_ref$params.password,networkId=_ref$params.networkId;if(!await wallet_validatePassword({password:password}))throw InvalidParams("Incorrect password");var network=getNetworkById(networkId);if(!network)throw InvalidParams(`Invalid network id ${networkId}`);if(network.builtin)throw InvalidParams("Not allowed to delete builtin network");return deleteNetworkById(networkId)}},290:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1147),NAME="wallet_detectAddressType",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["address",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32Address,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress]]]},permissions={external:["popup","inpage"],locked:!0,methods:["eth_getCode"],db:["getTokenByAddress"]},main=async function(_ref){var rst,InvalidParams=_ref.Err.InvalidParams,eth_getCode=_ref.rpcs.eth_getCode,getTokenByAddress=_ref.db.getTokenByAddress,address=_ref.params.address,type=_ref.network.type;if(getTokenByAddress(address).length>0)return{type:"contract"};if(address.includes(":"))return{type:Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_1__.a)(address).type};if("cfx"===type)throw InvalidParams("don't support detect hex address with cfx network");try{rst=await eth_getCode({errorFallThrough:!0},[address])}catch(err){}return rst&&"0x"!==rst?{type:"contract"}:{type:"unknown",contract:!1}}},291:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_detectNetworkType",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["url",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.url]]},permissions={external:["popup","inpage"],locked:!0},main=async function(_ref){var _rst,_rst2,rst,f=_ref.f,InvalidParams=_ref.Err.InvalidParams,url=_ref.params.url;try{rst=await f({networkName:url,network:{endpoint:url,name:url},method:"cfx_getStatus"},[])}catch(err){throw InvalidParams(`Invalid rpc endpoint ${url}`)}if(null!==(_rst=rst)&&void 0!==_rst&&_rst.result)return{chainId:rst.result.chainId,netId:parseInt(rst.result.networkId,16).toString(),type:"cfx"};try{rst=await f({networkName:url,network:{endpoint:url,name:url},method:"eth_chainId"},[])}catch(err){throw InvalidParams(`Invalid rpc endpoint ${url}`)}if(null!==(_rst2=rst)&&void 0!==_rst2&&_rst2.result){var netId=(await f({networkName:url,network:{endpoint:url,name:url},method:"net_version"},[])).result;return{netId:parseInt(netId,10).toString(),chainId:rst.result,type:"eth"}}throw InvalidParams("Unsupported network type")}},292:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1160),browser_passworder__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1149),NAME="wallet_exportAccount",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]]},permissions={db:["getAccountById","getAddressNetwork","getAccountAccountGroup"],methods:["wallet_validatePassword","wallet_exportAccountGroup"],external:["popup"]},main=async function(_ref){var _accountGroup$vault,InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAccountById=_ref$db.getAccountById,getAddressNetwork=_ref$db.getAddressNetwork,getAccountAccountGroup=_ref$db.getAccountAccountGroup,_ref$rpcs=_ref.rpcs,wallet_validatePassword=_ref$rpcs.wallet_validatePassword,wallet_exportAccountGroup=_ref$rpcs.wallet_exportAccountGroup,_ref$params=_ref.params,password=_ref$params.password,accountId=_ref$params.accountId;if(!await wallet_validatePassword({password:password}))throw InvalidParams("Invalid password");var account=getAccountById(accountId),accountGroup=getAccountAccountGroup(accountId);if(null==accountGroup||null===(_accountGroup$vault=accountGroup.vault)||void 0===_accountGroup$vault||!_accountGroup$vault.type)throw InvalidParams(`Invalid account id ${accountId}`);var vault=accountGroup.vault;if("hd"!==vault.type)return await wallet_exportAccountGroup({password:password,accountGroupId:accountGroup.eid});var decrypted=vault.ddata||Object(browser_passworder__WEBPACK_IMPORTED_MODULE_2__.decrypt)(password,vault.data),rst=account.address.map((async function(_ref2){var index=_ref2.index,hex=_ref2.hex,cfxHex=_ref2.cfxHex,base32=_ref2.base32,pk=_ref2.pk,eid=_ref2.eid,network=getAddressNetwork(eid),hdPath=network.hdPath.value;return{hex:hex,cfxHex:cfxHex,base32:base32,privateKey:pk||(await Object(_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_1__.a)({mnemonic:decrypted,hdPath:hdPath,nth:index,only0x1Prefixed:Boolean(vault.cfxOnly)})).privateKey,network:network}}));return await Promise.all(rst)}},293:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1147),_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1165),NAME="wallet_exportAccountGroup",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountGroupId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]]},permissions={db:["getAccountGroupById"],methods:["wallet_validatePassword"],external:["popup"]},main=async function(_ref){var _group$vault,InvalidParams=_ref.Err.InvalidParams,getAccountGroupById=_ref.db.getAccountGroupById,wallet_validatePassword=_ref.rpcs.wallet_validatePassword,_ref$params=_ref.params,password=_ref$params.password,accountGroupId=_ref$params.accountGroupId;if(!await wallet_validatePassword({password:password}))throw InvalidParams("Invalid password");var group=getAccountGroupById(accountGroupId);if(null==group||null===(_group$vault=group.vault)||void 0===_group$vault||!_group$vault.data)throw InvalidParams(`Invalid account group id ${accountGroupId}`);var decrypted=group.vault.ddata||await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(password,group.vault.data);return"pub"===group.vault.type&&group.vault.cfxOnly&&(decrypted=Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_2__.b)(decrypted,_fluent_wallet_consts__WEBPACK_IMPORTED_MODULE_3__.b)),decrypted}},294:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149),NAME="wallet_exportAll",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["encryptPassword",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]]},permissions={external:["popup"],methods:["wallet_validatePassword"],db:["getNetwork","getAccountGroup","getExportAllData"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,getExportAllData=_ref.db.getExportAllData,wallet_validatePassword=_ref.rpcs.wallet_validatePassword,_ref$params=_ref.params,password=_ref$params.password,encryptPassword=_ref$params.encryptPassword;if(!await wallet_validatePassword({password:password}))throw InvalidParams("Invalid password");return{encrypted:await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.encrypt)(encryptPassword,JSON.stringify(getExportAllData())),wallet:"fluent",version:"0"}}},295:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1147),_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1153),NAME="wallet_generateAddress",base=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0}],hex=["hex",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep],base32=["base32",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep],addrType=["type",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.addressType],cfx=["cfx",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep],ethAddressSchema=[].concat(base,[hex,["eth",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]]),cfxHexAddressSchema=[].concat(base,[hex,cfx,addrType]),cfxBase32AddressSchema=[].concat(base,[base32,cfx,addrType,["networkId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.networkId]]),schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,ethAddressSchema,cfxHexAddressSchema,cfxBase32AddressSchema]},permissions={locked:!0,external:["popup","inpage"]},main=function(_ref){var _ref$params=_ref.params,eth=_ref$params.eth,base32=_ref$params.base32,hex=_ref$params.hex,networkId=_ref$params.networkId,type=_ref$params.type;return eth?Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_2__.d)():hex?function(type){return type?Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_2__.d)(type):Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_2__.c)()}(type):base32?Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_1__.c)(type,networkId):void 0}},296:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var bip39__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1179),_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1143),NAME="wallet_generateMnemonic",schemas={output:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.mnemonic},permissions={locked:!0,external:["popup","inpage"]},main=function(){return Object(bip39__WEBPACK_IMPORTED_MODULE_0__.generateMnemonic)()}},297:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_account__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1153),_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1143),NAME="wallet_generatePrivateKey",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.optParam,output:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.privateKey},permissions={locked:!0,external:["popup","inpage"]};async function main(){return Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_0__.e)()}},298:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_getAccountAddressByNetwork",singleQuerySchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["networkId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]],schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,singleQuerySchema,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.oneOrMore,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.catn,["AccountAddressByNetworkQuery",singleQuerySchema]]]]},permissions={external:["popup"],db:["getAccountById","getNetworkById","accountAddrByNetwork"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAccountById=_ref$db.getAccountById,getNetworkById=_ref$db.getNetworkById,accountAddrByNetwork=_ref$db.accountAddrByNetwork,params=_ref.params;Array.isArray(params)||(params=[params]);var addrs=params.map((function(_ref2){var accountId=_ref2.accountId,networkId=_ref2.networkId;if(!getAccountById(accountId))throw InvalidParams(`Invalid account id ${accountId}`);if(!getNetworkById(networkId))throw InvalidParams(`Invalid network id ${networkId}`);return accountAddrByNetwork({account:accountId,network:networkId})}));return 1===addrs.length?addrs[0]:addrs}},299:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_getAccountGroup",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.maybe,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountGroupId",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["includeHidden",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep],["type",{optional:!0},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.enums,"hd","pk","pub"]]]]},permissions={db:["getAccountGroup"],external:["popup"]},main=function(_ref){var _ref$params=_ref.params,params=void 0===_ref$params?{}:_ref$params,getAccountGroup=_ref.db.getAccountGroup,accountGroupId=params.accountGroupId,includeHidden=params.includeHidden,type=params.type,query={};accountGroupId&&(query.eid=accountGroupId),includeHidden&&(query.hidden=!0);var accoungGroup=getAccountGroup(query)||[];return type?accoungGroup.filter((function(g){return g.vault.type===type})):accoungGroup}},300:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149),NAME="wallet_getAccountGroupVaultValue",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountGroupId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["password",{optional:!0,doc:"required when calling from popup"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]]},permissions={external:["popup","inpage"],db:["getPassword","getAccountGroupById"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getPassword=_ref$db.getPassword,getAccountGroupById=_ref$db.getAccountGroupById,_ref$params=_ref.params,password=_ref$params.password,accountGroupId=_ref$params.accountGroupId;if(_ref._popup&&password!==getPassword())throw InvalidParams("Invalid password");var group=getAccountGroupById(accountGroupId);if(!group)throw InvalidParams(`Invalid account group id ${accountGroupId}`);return password=getPassword(),group.vault.ddata||await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(password,group.vault.data)}},301:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149),_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1160),_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1158),NAME="wallet_getAddressPrivateKey",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["addressId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["password",{optional:!0,doc:"required when calling from popup"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]]},permissions={external:["popup"],methods:[],db:["getAddressById","getPassword","getAddressNetwork"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getPassword=_ref$db.getPassword,getAddressById=_ref$db.getAddressById,getAddressNetwork=_ref$db.getAddressNetwork,_ref$params=_ref.params,password=_ref$params.password,addressId=_ref$params.addressId;if(_ref._popup&&password!==getPassword())throw InvalidParams("Invalid password");var addr=getAddressById(addressId);if(!addr)throw InvalidParams(`Invalid address id ${addressId}`);if(addr.pk)return Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.a)(addr.pk);var vault=addr.vault;if("pub"===vault.type)throw InvalidParams(`Invalid address id ${addressId}, the address vault is pub only`);if(password=getPassword(),"pk"===vault.type)return Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.a)(vault.ddata||await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(password,vault.data));if("hd"===vault.type){var mnemonic=vault.ddata||await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(password,vault.data),network=getAddressNetwork(addressId),privateKey=(await Object(_fluent_wallet_hdkey__WEBPACK_IMPORTED_MODULE_2__.a)({mnemonic:mnemonic,hdPath:network.hdPath.value,nth:addr.index,only0x1Prefixed:vault.cfxOnly})).privateKey;return Object(_fluent_wallet_utils__WEBPACK_IMPORTED_MODULE_3__.a)(privateKey)}}},302:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_getCurrentAccount",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup"],methods:[],db:["getOneAccount"]},main=function(_ref){return(0,_ref.db.getOneAccount)({selected:!0})}},303:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_getCurrentNetwork",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup"],methods:[],db:["getOneNetwork"]},main=function(_ref){return(0,_ref.db.getOneNetwork)({selected:!0})}},304:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_getCurrentViewingApp",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup"],methods:[],db:["getAppBySite","getSiteByOrigin"]},main=async function(_ref){var t,_ref$db=_ref.db,getAppBySite=_ref$db.getAppBySite,getSiteByOrigin=_ref$db.getSiteByOrigin;try{var _t,_t2,tab=(await Promise.all([__webpack_require__.e(0),__webpack_require__.e(1)]).then(__webpack_require__.bind(null,1169))).tab;if(null===(_t=t=await tab.getCurrent())||void 0===_t||!_t.length)return null;if(null===(_t2=t=t[0])||void 0===_t2||!_t2.url)return null}catch(err){return null}var site=_slicedToArray(getSiteByOrigin(t.url.split("/")[2]),1)[0];return site?{site:site,app:_slicedToArray(getAppBySite(site.eid),1)[0]}:null}},305:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1159),NAME="wallet_getNetwork",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["type",{optional:!0},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.enums,"cfx","eth"]],["builtin",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.boolean],["chainId",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.chainId],["networkId",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.networkId],["networkDbId",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={external:["popup"],methods:[],db:["getNetwork","getNetworkById"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getNetwork=_ref$db.getNetwork,getNetworkById=_ref$db.getNetworkById,_ref$params=_ref.params,type=_ref$params.type,builtin=_ref$params.builtin,networkId=_ref$params.networkId,networkDbId=_ref$params.networkDbId,chainId=_ref$params.chainId,networkDbIdDefined=!Object(_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__.c)(networkDbId),builtinDefined=!Object(_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__.c)(builtin),networkIdDefined=!Object(_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__.c)(networkId);if((type||chainId||networkIdDefined||builtinDefined)&&networkDbIdDefined)throw InvalidParams("Can't query type/builtin/chainId/networkId with networkDbId at the same time");if(networkDbIdDefined)return getNetworkById(networkDbId);var query={};return type&&(query.type=type),builtinDefined&&(query.builtin=builtin),networkIdDefined&&(query.networkId=networkId),chainId&&(query.chainId=chainId),getNetwork(query)}},306:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_addr_by_network__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1186);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_getNextNonce",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress],[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.cat,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress]]},permissions={locked:!0,methods:["cfx_getNextNonce","eth_getTransactionCount"],external:["popup","inpage"]},main=async function(_ref){var _ref$rpcs=_ref.rpcs,eth_getTransactionCount=_ref$rpcs.eth_getTransactionCount,cfx_getNextNonce=_ref$rpcs.cfx_getNextNonce,address=_slicedToArray(_ref.params,1)[0],_ref$network=_ref.network,netId=_ref$network.netId,type=_ref$network.type;address=Object(_fluent_wallet_addr_by_network__WEBPACK_IMPORTED_MODULE_1__.a)({address:address,networkType:type,networkId:netId});var getNextNonce="cfx"===type?cfx_getNextNonce:eth_getTransactionCount;return await getNextNonce([address])}},307:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_getPendingAuthRequest",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup"],methods:[],db:["getAuthReq"]},main=function(_ref){return(0,_ref.db.getAuthReq)()}},308:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_getPermissions",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["inpage"]},main=function(_ref){var InvalidRequest=_ref.Err.InvalidRequest,app=_ref.app;if(!app)throw InvalidRequest();return Object.keys(app.perms).reduce((function(acc,p){return[].concat(_toConsumableArray(acc),[{invoker:app.site.origin,parentCapability:p,date:app.permUpdatedAt}])}),[])}},309:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_importAddress",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["nickname",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nickname],["password",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["address",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress]]]},permissions={methods:["wallet_addVault"],external:["popup"]},main=async function(_ref){var _ref$params=_ref.params,password=_ref$params.password,address=_ref$params.address,nickname=_ref$params.nickname,wallet_addVault=_ref.rpcs.wallet_addVault;return nickname?await wallet_addVault({password:password,address:address.toLowerCase(),nickname:nickname}):await wallet_addVault({password:password,address:address.toLowerCase()})}},310:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_importAll",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["decryptPassword",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["vaults",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp]]},permissions={external:["popup"],locked:!0,methods:["wallet_validatePassword","wallet_addVault"],db:["t"]},main=async function(_ref){var data,decrypted,_ref$Err=_ref.Err,InvalidParams=_ref$Err.InvalidParams,Internal=_ref$Err.Internal,_ref$rpcs=_ref.rpcs,wallet_addVault=_ref$rpcs.wallet_addVault,wallet_validatePassword=_ref$rpcs.wallet_validatePassword,_ref$params=_ref.params,password=_ref$params.password,decryptPassword=_ref$params.decryptPassword,vaults=_ref$params.vaults;if(!await wallet_validatePassword({password:password}))throw InvalidParams("Invalid password");try{data=JSON.parse(vaults)}catch(err){throw InvalidParams("Invalid vaults data, must be a valid json string")}if(!data.wallet||!data.encrypted)throw InvalidParams("Invalid vaults data");try{decrypted=await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(decryptPassword,data.encrypted),JSON.parse(decrypted)}catch(err){throw InvalidParams("Invalid vaults data")}if("fluent"===data.wallet){if(!window)throw Internal("Invalid running env, window is not defined");var _browser$runtime,_browser$runtime$relo,browser=(await __webpack_require__.e(0).then(__webpack_require__.t.bind(null,1157,7))).default;return await browser.storage.local.set({wallet_importAll:decrypted}),void(null==browser||null===(_browser$runtime=browser.runtime)||void 0===_browser$runtime||null===(_browser$runtime$relo=_browser$runtime.reload)||void 0===_browser$runtime$relo||_browser$runtime$relo.call(_browser$runtime))}if("portal"===data.wallet){if(decrypted=JSON.parse(decrypted),!Array.isArray(decrypted))throw InvalidParams("Invalid vaults data");var _step,rst=[],_iterator=function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(e){didErr=!0,err=e},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(decrypted);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _ref3=_slicedToArray(_step.value,2),type=_ref3[0],cred=_ref3[1];if("hd"!==type&&"pk"!==type)throw InvalidParams(`Invalid type ${type} of credentials`);rst.push(await wallet_addVault({password:password,["hd"===type?"mnemonic":"privateKey"]:cred}))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return rst}}},311:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_importMnemonic",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["nickname",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nickname],["mnemonic",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.mnemonic],["password",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["waitTillFinish",{optional:!0},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.maybe,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]],["cfxOnly",{optional:!0,doc:"only derive conflux compatible address from this mnemonic"},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.maybe,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]],["force",{optional:!0,doc:"set to true to skip duplication check"},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.maybe,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]]]},permissions={methods:["wallet_addVault"],external:["popup"]},main=async function(_ref){var params=_ref.params,wallet_addVault=_ref.rpcs.wallet_addVault;return await wallet_addVault(params)}},312:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_importPrivateKey",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["nickname",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nickname],["privateKey",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.privateKey],["password",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]]},permissions={methods:["wallet_addVault"],external:["popup"]},main=async function(_ref){var params=_ref.params,wallet_addVault=_ref.rpcs.wallet_addVault;return await wallet_addVault(params)}},313:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var NAME="wallet_isLocked",permissions={db:["getLocked"],external:["popup"],locked:!0},main=function(_ref){return(0,_ref.db.getLocked)()}},314:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var NAME="wallet_lock",schemas={},permissions={db:["setLocked"],external:["popup"]},main=async function(_ref){(0,_ref.db.setLocked)(!0)}},315:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_refetchBalance",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["type",{optional:!0,doc:"all for fetch balance of all tokens rather than tokens under each address"},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.enums,"all"]],["allNetwork",{optional:!0,doc:"true to refetch balance of all network"},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]]]},permissions={external:["popup"],locked:!0,methods:["wallet_getBalance"],db:["getSingleCallBalanceParams","upsertBalances"]},main=async function(_ref){var _ref$db=_ref.db,getSingleCallBalanceParams=_ref$db.getSingleCallBalanceParams,upsertBalances=_ref$db.upsertBalances,params=_ref.params,wallet_getBalance=_ref.rpcs.wallet_getBalance,promises=getSingleCallBalanceParams({type:(null==params?void 0:params.type)||"refresh",allNetwork:Boolean(null==params?void 0:params.allNetwork)}).map((function(_ref2){var _ref3=_slicedToArray(_ref2,2),_ref3$=(_ref3[0],_slicedToArray(_ref3[1],3)),users=_ref3$[0],tokens=_ref3$[1],network=_ref3$[2];return wallet_getBalance({network:network,networkName:network.name},{users:users,tokens:tokens}).then((function(rst){return rst&&upsertBalances({data:rst,networkId:network.eid})}))}));return await Promise.all(promises),!0}},316:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_refetchTokenList",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup"],methods:["wallet_updateTokenList"],db:["getNetwork"]},main=async function(_ref){var getNetwork=_ref.db.getNetwork,wallet_updateTokenList=_ref.rpcs.wallet_updateTokenList,promises=getNetwork().reduce((function(acc,n){return n.tokenList?acc.concat([wallet_updateTokenList({networkId:n.eid,tokenList:{url:n.tokenList.url,name:n.tokenList.name}})]):acc}),[]);return await Promise.all(promises)}},317:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_registerSiteMetadata",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["name",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp],["icon",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.url]]},permissions={external:["inpage"],locked:!0,methods:[],db:["t"],scope:null},main=function(_ref){var InvalidRequest=_ref.Err.InvalidRequest,t=_ref.db.t,_ref$params=_ref.params,name=_ref$params.name,icon=_ref$params.icon,_inpage=_ref._inpage,_origin=_ref._origin,_post=_ref._post,network=_ref.network;if(_inpage&&!_origin)throw InvalidRequest("no origin found");t([{eid:"newsite",site:{name:name,origin:_origin,post:_post}},icon&&{eid:"newsite",site:{icon:icon}}]),_post({event:"connect",params:{chainId:network.chainId,networkId:network.netId}})}},318:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_csp__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1226),NAME="wallet_requestUnlockUI",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={locked:!0,db:["getLocked","t","getUnlockReq","retract"]};var main=async function(args){var UserRejected=args.Err.UserRejected,_args$db=args.db,getLocked=_args$db.getLocked,getUnlockReq=_args$db.getUnlockReq,t=_args$db.t;if(getLocked()){var unlockReqs=getUnlockReq(),unlocked=!1;if(unlockReqs.length)unlocked=await unlockReqs[0].read();else{var c=Object(_fluent_wallet_csp__WEBPACK_IMPORTED_MODULE_1__.a)(1);t([{unlockReq:{req:c}}]),async function requestUnlockUI(_ref){var Internal=_ref.Err.Internal,_ref$db=_ref.db,getLocked=_ref$db.getLocked,getUnlockReq=_ref$db.getUnlockReq,retract=_ref$db.retract,MODE=_ref.MODE;if(!window)throw Internal("Invalid running env, window is not defined");var _await$import=await Promise.all([__webpack_require__.e(0),__webpack_require__.e(1)]).then(__webpack_require__.bind(null,1169)),browser=_await$import.browser,popup=_await$import.popup,w=await popup.show({url:"popup.html#/unlock",alwaysOnTop:!!MODE.isProd,mdoe:MODE});MODE.isProd&&popup.onFocusChanged(null==w?void 0:w.id,popup.remove),popup.onRemoved(null==w?void 0:w.id,(function windowOnRemovedListener(){browser.windows.onRemoved.removeListener(windowOnRemovedListener),getLocked()&&(getUnlockReq()||[]).forEach((function(_ref2){var eid=_ref2.eid;return _ref2.req.write(!1).then((function(){return retract(eid)}))}))}))}(args),unlocked=await c.read()}if(!unlocked)throw UserRejected()}}},319:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_setAppCurrentAccount",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["appId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={external:["popup"],db:["getAccountById","getAppById","t","accountAddrByNetwork"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAccountById=_ref$db.getAccountById,t=_ref$db.t,accountAddrByNetwork=_ref$db.accountAddrByNetwork,getAppById=_ref$db.getAppById,_ref$params=_ref.params,accountId=_ref$params.accountId,appId=_ref$params.appId;if(!getAccountById(accountId))throw InvalidParams(`Invalid accountId ${accountId}`);var app=getAppById(appId);if(!app)throw InvalidParams(`Invalid app id ${appId}`);if(!app.account||!app.account.map((function(_ref2){return _ref2.eid})).includes(accountId))throw InvalidParams(`Account ${accountId} not authorized for app ${app.eid}`);t([{eid:app.eid,app:{currentAccount:accountId}}]);var currentNetwork=app.currentNetwork,post=app.site.post;if(post){var addr=accountAddrByNetwork({account:accountId,network:currentNetwork.eid});post({event:"accountsChanged",params:["cfx"===currentNetwork.type?addr.base32:addr.hex]})}}},320:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_setAppCurrentNetwork",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["appId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["networkId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={external:["popup"],db:["getNetworkById","getAppById","t"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getNetworkById=_ref$db.getNetworkById,getAppById=_ref$db.getAppById,t=_ref$db.t,_ref$params=_ref.params,appId=_ref$params.appId,networkId=_ref$params.networkId,network=getNetworkById(networkId);if(!network)throw InvalidParams(`Invalid network ${networkId}`);var app=getAppById(appId);if(!app)throw InvalidParams(`Invalid app id ${appId}`);t([{eid:app.eid,app:{currentNetwork:networkId}}]);var post=app.site.post;post&&post({event:"chainChanged",params:network.chainId})}},321:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_setCurrentAccount",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.oneOrMore,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.catn,["accountId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]]},permissions={external:["popup"],methods:[],db:["setCurrentAccount","getAccountById","accountAddrByNetwork"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,setCurrentAccount=_ref$db.setCurrentAccount,getAccountById=_ref$db.getAccountById,accountAddrByNetwork=_ref$db.accountAddrByNetwork,account=_slicedToArray(_ref.params,1)[0];if(!getAccountById(account))throw InvalidParams(`Invalid accountId ${account}`);setCurrentAccount(account).forEach((function(_ref2){var currentAccount=_ref2.currentAccount,currentNetwork=_ref2.currentNetwork,post=_ref2.site.post;if(post){var addr=accountAddrByNetwork({account:currentAccount.eid,network:currentNetwork.eid});post({event:"accountsChanged",params:["cfx"===currentNetwork.type?addr.base32:addr.hex]})}}))}},322:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_setCurrentNetwork",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.oneOrMore,[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.catn,["networkId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]]},permissions={external:["popup"],methods:[],db:["setCurrentNetwork","getNetworkById"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,setCurrentNetwork=_ref$db.setCurrentNetwork,getNetworkById=_ref$db.getNetworkById,network=_slicedToArray(_ref.params,1)[0];if(!getNetworkById(network))throw InvalidParams(`Invalid networkId ${network}`);setCurrentNetwork(network).forEach((function(_ref2){var currentNetwork=_ref2.currentNetwork,post=_ref2.site.post;return post&&post({event:"chainChanged",params:currentNetwork.chainId})}))}},323:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_wallet_switch_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(243);__webpack_require__.d(__webpack_exports__,"schemas",(function(){return _fluent_wallet_wallet_switch_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__.schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return _fluent_wallet_wallet_switch_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__.permissions}));var NAME="wallet_switchConfluxChain",main=Object(_fluent_wallet_wallet_switch_ethereum_chain__WEBPACK_IMPORTED_MODULE_0__.generateMain)("cfx")},324:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_unlock",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password],["waitSideEffects",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]]},permissions={locked:!0,external:["popup"],methods:["wallet_validatePassword","wallet_refetchTokenList","wallet_refetchBalance"],db:["setPassword","getUnlockReq","retract"]},main=async function(_ref){var _ref$params=_ref.params,password=_ref$params.password,waitSideEffects=_ref$params.waitSideEffects,_ref$db=_ref.db,setPassword=_ref$db.setPassword,retract=_ref$db.retract,getUnlockReq=_ref$db.getUnlockReq,_ref$rpcs=_ref.rpcs,wallet_validatePassword=_ref$rpcs.wallet_validatePassword,wallet_refetchTokenList=_ref$rpcs.wallet_refetchTokenList,wallet_refetchBalance=_ref$rpcs.wallet_refetchBalance,InvalidParams=_ref.Err.InvalidParams;if(!await wallet_validatePassword({password:password}))throw InvalidParams("Invalid password");setPassword(password),(getUnlockReq()||[]).forEach((function(_ref2){var req=_ref2.req,eid=_ref2.eid;return req.write(!0).then((function(){return retract(eid)}))}));var promise=wallet_refetchTokenList().then((function(){return wallet_refetchBalance({type:"all",allNetwork:!0})}));waitSideEffects&&await promise}},325:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_unwatchAsset",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["tokenId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={external:["popup"],methods:[],db:["retractAddressToken","getAddressById","getTokenById"]},main=function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,retractAddressToken=_ref$db.retractAddressToken,getAddressById=_ref$db.getAddressById,getTokenById=_ref$db.getTokenById,_ref$params=_ref.params,tokenId=_ref$params.tokenId,addressId=_ref$params.addressId;if(!getTokenById(tokenId))throw InvalidParams(`Invalid tokenId ${tokenId}`);if(!getAddressById(addressId))throw InvalidParams(`Invalid addressId ${addressId}`);if("tokenNotBelongToAddress"===retractAddressToken({tokenId:tokenId,addressId:addressId}))throw InvalidParams(`Token [${tokenId}] not belong to address [${addressId}]`);return!0}},326:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1159),NAME="wallet_updateAccount",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["nickname",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nickname],["offline",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.boolean],["hidden",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.boolean]]},permissions={db:["t","getAccountById","getAccountGroup","anyDupNickAccount"],external:["popup"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAccountById=_ref$db.getAccountById,t=_ref$db.t,anyDupNickAccount=_ref$db.anyDupNickAccount,_ref$params=_ref.params,nickname=_ref$params.nickname,hidden=_ref$params.hidden,accountId=_ref$params.accountId,offline=_ref$params.offline;if(!getAccountById(accountId))throw InvalidParams(`Invalid account id ${accountId}`);if(nickname&&anyDupNickAccount({accountId:accountId,nickname:nickname}))throw InvalidParams(`Invalid nickname ${nickname}, duplicate with other account in the same account group`);t([nickname&&{eid:accountId,account:{nickname:nickname}},Object(_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__.a)(hidden)&&{eid:accountId,account:{hidden:hidden}},!Object(_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__.c)(offline)&&{eid:accountId,account:{offline:offline}}])}},327:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1159),NAME="wallet_updateAccountGroup",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["accountGroupId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["nickname",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.nickname],["hidden",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.boolean]]},permissions={db:["t","getAccountGroupById","getAccountGroupByNickname"],external:["popup"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAccountGroupById=_ref$db.getAccountGroupById,t=_ref$db.t,getAccountGroupByNickname=_ref$db.getAccountGroupByNickname,_ref$params=_ref.params,nickname=_ref$params.nickname,hidden=_ref$params.hidden,accountGroupId=_ref$params.accountGroupId;if(!getAccountGroupById(accountGroupId))throw InvalidParams(`Invalid accountGroupId ${accountGroupId}`);if(nickname&&getAccountGroupByNickname(nickname).length)throw InvalidParams(`Invalid nickname ${nickname}, duplicate with other account group`);t([nickname&&{eid:accountGroupId,accountGroup:{nickname:nickname}},Object(_fluent_wallet_checks__WEBPACK_IMPORTED_MODULE_1__.a)(hidden)&&{eid:accountGroupId,accountGroup:{hidden:hidden}}])}},328:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_userApprovedAuthRequest",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["authReqId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["res",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.anyp]]},permissions={db:["getAuthReqById","retract","getAuthReq"]},main=async function(_ref){var _getAuthReq,InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,retract=_ref$db.retract,getAuthReqById=_ref$db.getAuthReqById,getAuthReq=_ref$db.getAuthReq,_ref$params=_ref.params,authReqId=_ref$params.authReqId,res=_ref$params.res,authReq=getAuthReqById(authReqId);if(!authReq)throw InvalidParams(`Invalid auth request id ${authReqId}`);(authReq.c&&authReq.c.write(res),retract(authReqId),null!==(_getAuthReq=getAuthReq())&&void 0!==_getAuthReq&&_getAuthReq.length)||(await Promise.all([__webpack_require__.e(0),__webpack_require__.e(1)]).then(__webpack_require__.bind(null,1169))).popup.removePopup()}},329:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_userRejectedAuthRequest",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["authReqId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid]]},permissions={db:["getAuthReqById","retract","getAuthReq"],external:["popup"]},main=async function(_ref){var _getAuthReq,_ref$Err=_ref.Err,InvalidParams=_ref$Err.InvalidParams,UserRejected=_ref$Err.UserRejected,_ref$db=_ref.db,retract=_ref$db.retract,getAuthReqById=_ref$db.getAuthReqById,getAuthReq=_ref$db.getAuthReq,authReqId=_ref.params.authReqId,authReq=getAuthReqById(authReqId);if(!authReq)throw InvalidParams(`Invalid auth request id ${authReqId}`);if(authReq.c){var error=UserRejected();error.rpcData=authReq.req,authReq.c.write(error)}(retract(authReqId),null!==(_getAuthReq=getAuthReq())&&void 0!==_getAuthReq&&_getAuthReq.length)||(await Promise.all([__webpack_require__.e(0),__webpack_require__.e(1)]).then(__webpack_require__.bind(null,1169))).popup.removePopup()}},330:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_validateAppPermissions",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["permissions",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.mapp]]},permissions={locked:!0,external:[]},main=function(_ref){var perms=_ref.params,app=_ref.app;return Object.keys(perms).reduce((function(acc,p){var _app$perms;return acc||(null===(_app$perms=app.perms)||void 0===_app$perms?void 0:_app$perms[p])}),!1)}},331:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),bip39__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1179),NAME="wallet_validateMnemonic",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["mnemonic",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp,{min:1}]]]},permissions={external:["popup","inpage"],locked:!0};var main=function(_ref){var mnemonic=_ref.params.mnemonic,words=mnemonic.split(" ").map((function(w){return null==w?void 0:w.trim()})).filter((function(w){return Boolean(w)})),lang=function getWordListByWord(word){for(var lang in bip39__WEBPACK_IMPORTED_MODULE_1__.wordlists){var _wordlists$lang;if(null!==(_wordlists$lang=bip39__WEBPACK_IMPORTED_MODULE_1__.wordlists[lang])&&void 0!==_wordlists$lang&&_wordlists$lang.includes(word))return lang}}(words[0]);if(!lang)return{valid:!1,invalidWord:words[0]};for(var wordlist=bip39__WEBPACK_IMPORTED_MODULE_1__.wordlists[lang],i=0;i<words.length;i++)if(!wordlist.includes(words[i]))return{valid:!1,invalidWord:words[i]};return{valid:Object(bip39__WEBPACK_IMPORTED_MODULE_1__.validateMnemonic)(mnemonic,wordlist)}}},332:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),browser_passworder__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1149),NAME="wallet_validatePassword",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["password",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.password]],output:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.boolean},permissions={locked:!0,db:["getVault","getPassword","getLocked"]};async function main(_ref){var _ref$db=_ref.db,getVault=_ref$db.getVault,getLocked=_ref$db.getLocked,getPassword=_ref$db.getPassword,password=_ref.params.password;if(!getLocked())return password===getPassword();var vaults=getVault();if(!vaults.length)return!0;var valid=!1;try{await Object(browser_passworder__WEBPACK_IMPORTED_MODULE_1__.decrypt)(password,vaults[0].data),valid=!0}catch(err){valid=!1}return valid}},333:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_account__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1153),_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1143),NAME="wallet_validatePrivateKey",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.map,{closed:!0},["privateKey",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_1__.stringp,{min:1}]]]},permissions={external:["popup","inpage"],locked:!0},main=function(_ref){var privateKey=_ref.params.privateKey;return{valid:Object(_fluent_wallet_account__WEBPACK_IMPORTED_MODULE_0__.g)(privateKey)}}},334:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1147),_fluent_wallet_contract_abis_777_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1229),NAME="wallet_validate20Token",schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,["tokenAddress",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32ContractAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress]],["name",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.stringp],["symbol",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.tokenSymbol],["decimals",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.integer],["userAddress",{optional:!0},[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32UserAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress]],["addressId",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["selectedAccountAddress",{optional:!0},_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.truep]]},permissions={external:["popup","inpage"],methods:["cfx_call","eth_call"],db:["getCurrentAddr","getAddressById"]},main=async function(_ref){var uaddr,InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getCurrentAddr=_ref$db.getCurrentAddr,getAddressById=_ref$db.getAddressById,_ref$rpcs=_ref.rpcs,cfx_call=_ref$rpcs.cfx_call,eth_call=_ref$rpcs.eth_call,_ref$params=_ref.params,name=_ref$params.name,symbol=_ref$params.symbol,decimals=_ref$params.decimals,tokenAddress=_ref$params.tokenAddress,userAddress=_ref$params.userAddress,addressId=_ref$params.addressId,selectedAccountAddress=_ref$params.selectedAccountAddress,type=_ref.network.type;if(addressId&&userAddress||addressId&&selectedAccountAddress||userAddress&&selectedAccountAddress)throw InvalidParams("don't support providing userAddress addressId selectedAccountAddress at the same time");if(addressId){var addr=getAddressById(addressId);if(!addr)throw InvalidParams(`Invalid addressId ${addressId}`);uaddr=addr.hex}userAddress&&"cfx"===type&&(uaddr=Object(_fluent_wallet_base32_address__WEBPACK_IMPORTED_MODULE_1__.a)(userAddress).hexAddress),selectedAccountAddress&&(uaddr=getCurrentAddr().hex);var call="cfx"===type?cfx_call:eth_call;return await Object(_fluent_wallet_contract_abis_777_js__WEBPACK_IMPORTED_MODULE_2__.b)((function(d){return call({errorFallThrough:!0},[d])}),{name:name,decimals:decimals,symbol:symbol,address:tokenAddress,userAddress:uaddr})}},335:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_watchAsset",publicSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["type",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.enums,"ERC20","CRC20"]],["options",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,["address",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.base32ContractAddress,_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.ethHexAddress]],["symbol",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.tokenSymbol],["decimals",[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.posInt,{max:255}]],["image",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.url]]]],internalSchema=[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.map,{closed:!0},["authReqId",_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.dbid],["asset",publicSchema]],schemas={input:[_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.or,publicSchema,internalSchema]},permissions={external:["popup","inpage"],methods:["wallet_addPendingUserAuthRequest","wallet_userApprovedAuthRequest","wallet_validate20Token"],db:["getAuthReqById","accountAddrByNetwork","getCurrentAddr","addTokenToAddr"]},main=async function(_ref){var InvalidParams=_ref.Err.InvalidParams,_ref$db=_ref.db,getAuthReqById=_ref$db.getAuthReqById,accountAddrByNetwork=_ref$db.accountAddrByNetwork,addTokenToAddr=_ref$db.addTokenToAddr,getCurrentAddr=_ref$db.getCurrentAddr,_ref$rpcs=_ref.rpcs,wallet_addPendingUserAuthRequest=_ref$rpcs.wallet_addPendingUserAuthRequest,wallet_userApprovedAuthRequest=_ref$rpcs.wallet_userApprovedAuthRequest,wallet_validate20Token=_ref$rpcs.wallet_validate20Token,app=_ref.app,params=_ref.params,_popup=_ref._popup;if(null!=params&&params.type){var address=params.options.address,_await$wallet_validat=await wallet_validate20Token(Object.assign({},params.options,{tokenAddress:address})),name=_await$wallet_validat.name,symbol=_await$wallet_validat.symbol,decimals=_await$wallet_validat.decimals;if(!_await$wallet_validat.valid)throw InvalidParams("Invalid token");if(_popup){var _curAddr=getCurrentAddr();return addTokenToAddr(Object.assign({},params.options,{name:name,symbol:symbol,address:address,decimals:decimals,targetAddressId:_curAddr.eid,fromUser:!0})),!0}var curAddr=accountAddrByNetwork({network:app.currentNetwork.eid,account:app.currentAccount.eid});return!!addTokenToAddr(Object.assign({},params.options,{targetAddressId:curAddr.eid,checkOnly:!0})).alreadyInAddr||await wallet_addPendingUserAuthRequest({appId:app.eid,req:{method:NAME,params:Object.assign({},params,{options:Object.assign({},params.options,{name:name,symbol:symbol,decimals:decimals})})}})}if(params.authReqId){var authReq=getAuthReqById(params.authReqId);if(!authReq)throw InvalidParams(`Invalid auth req id ${params.authReqId}`);var authedApp=authReq.app,addr=accountAddrByNetwork({network:authedApp.currentNetwork.eid,account:authedApp.currentAccount.eid});return addTokenToAddr(Object.assign({},authReq.req.params.options,{targetAddressId:addr.eid,fromApp:!0})),await wallet_userApprovedAuthRequest({authReqId:params.authReqId,res:!0})}}},336:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var _fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1143),NAME="wallet_zeroAccountGroup",schemas={input:_fluent_wallet_spec__WEBPACK_IMPORTED_MODULE_0__.optParam},permissions={external:["popup"],locked:!0,db:["getAccountGroup"]},main=function(_ref){var _getAccountGroup;return!(null!==(_getAccountGroup=(0,_ref.db.getAccountGroup)())&&void 0!==_getAccountGroup&&_getAccountGroup.length)}},337:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return wallet_requestPermissions_permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var packages_spec=__webpack_require__(1143),permissions={wallet_basic:{},wallet_accounts:{},cfx_accounts:{},eth_accounts:{},wallet_networks:{}},docs={wallet_basic:{en:"permission for basic rpc methods that do not request user address or signature, eg. cfx_epochNumber, eth_blockNumber, wallet_generatePrivateKey, this permission is added by default"},wallet_accounts:{en:"permission for methods that need user address or signature, eg. cfx_sendTransaction, eth_signTypedData_v4"},cfx_accounts:{en:"alias for wallet_account"},eth_accounts:{en:"alias for wallet_account"},wallet_networks:{en:"permission for methods related to network change, eg. wallet_addEthereumChain, wallet_switchConfluxChain, this permission is added by default"}};function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var spec,mapp,map,and,empty,catn=packages_spec.catn,wallet_requestPermissions_map=packages_spec.map,dbid=packages_spec.dbid,or=packages_spec.or,zeroOrMore=packages_spec.zeroOrMore,oneOrMore=packages_spec.oneOrMore,NAME="wallet_requestPermissions",publicSchema=[zeroOrMore,[catn,["permission",(mapp=(spec=packages_spec).mapp,map=spec.map,and=spec.and,empty=spec.empty,[map].concat(_toConsumableArray(Object.keys(permissions).map((function(permissionName){var _docs$permissionName;return[permissionName,{optional:!0,doc:(null===(_docs$permissionName=docs[permissionName])||void 0===_docs$permissionName?void 0:_docs$permissionName.en)||`${permissionName} wallet permission`},[and,mapp,empty]]})))))]]],schemas={input:[or,publicSchema,[or,[wallet_requestPermissions_map,{closed:!0,doc:"used to approve/reject the request"},["authReqId",dbid],["permissions",publicSchema],["accounts",[zeroOrMore,[catn,["accountId",dbid]]]]],[wallet_requestPermissions_map,{closed:!0,doc:"used to grant permissions to app from wallet"},["siteId",dbid],["permissions",publicSchema],["accounts",[oneOrMore,[catn,["accountId",dbid]]]]]]]},wallet_requestPermissions_permissions={external:["inpage","popup"],locked:!0,methods:["wallet_addPendingUserAuthRequest","wallet_userApprovedAuthRequest","wallet_userRejectedAuthRequest"],db:["upsertAppPermissions","getSiteById","getOneSite","getAuthReqById","getOneAccount","getAccountById"],scope:null},formatPermissions=function(perms){return perms.map((function(p){return Object.keys(p).reduce((function(p,key){return"cfx_accounts"!==key&&"eth_accounts"!==key||(key="wallet_accounts"),Object.assign({},p,{[key]:{}})}),{wallet_basic:{}})}))},main=async function(_ref){var _ref$Err=_ref.Err,InvalidRequest=_ref$Err.InvalidRequest,InvalidParams=_ref$Err.InvalidParams,_ref$db=_ref.db,upsertAppPermissions=_ref$db.upsertAppPermissions,getAuthReqById=_ref$db.getAuthReqById,getAccountById=_ref$db.getAccountById,getOneAccount=_ref$db.getOneAccount,getSiteById=_ref$db.getSiteById,_ref$rpcs=_ref.rpcs,wallet_addPendingUserAuthRequest=_ref$rpcs.wallet_addPendingUserAuthRequest,wallet_userApprovedAuthRequest=_ref$rpcs.wallet_userApprovedAuthRequest,wallet_userRejectedAuthRequest=_ref$rpcs.wallet_userRejectedAuthRequest,network=_ref.network,params=_ref.params,_popup=_ref._popup,_internal=_ref._internal,_inpage=_ref._inpage,_origin=_ref._origin,site=_ref.site,app=_ref.app;if((_inpage||_internal)&&!_origin)throw InvalidRequest("no origin found");if(_inpage||_internal){var perms=formatPermissions(params);if(app&&JSON.stringify(app.perms)===JSON.stringify(perms))return app.perms;var req={method:NAME,params:perms};return await wallet_addPendingUserAuthRequest({siteId:site.eid,req:req})}if(_popup){if(params.siteId&&!params.accounts.length)throw InvalidParams("Must have at least 1 accounts");var authReqId=params.authReqId,_permissions=params.permissions,siteId=params.siteId;if(authReqId){var authReq=getAuthReqById(authReqId);if(!authReq)throw InvalidParams(`Invalid auth req id ${authReqId}`);if(!params.accounts.length)return await wallet_userRejectedAuthRequest({authReqId:authReqId});siteId=authReq.site.eid}if(siteId&&!getSiteById(siteId))throw InvalidParams(`Invalid site id ${siteId}`);for(var accounts=params.accounts.map(getAccountById),i=0;i<accounts.length;i++)if(!accounts[i])throw InvalidParams(`Invalid account id ${params.accounts[i]}`);var currentAccount=getOneAccount({selected:!0}).eid;accounts.includes(currentAccount)||(currentAccount=accounts[0].eid);var _perms=formatPermissions(_permissions);return upsertAppPermissions({siteId:siteId,accounts:accounts.map((function(a){return a.eid})),currentAccount:currentAccount,currentNetwork:network.eid,perms:_perms[0]}),authReqId?await wallet_userApprovedAuthRequest({authReqId:authReqId,res:_perms}):null}}},338:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var spec=__webpack_require__(1143),addr_by_network=__webpack_require__(1186),hdkey=__webpack_require__(1160),utils=__webpack_require__(1158),bn=__webpack_require__(1417),bn_default=__webpack_require__.n(bn),checks=__webpack_require__(1159);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ZERO=new bn_default.a(0,10),hasTx=async function(_ref){var getTxCount=_ref.getTxCount,address=_ref.address,rst=!1;try{var res=await getTxCount([address]);new bn_default.a(Object(utils.c)(res),16).gt(ZERO)&&(rst=!0)}catch(err){}return rst},hasBalance=async function(_ref2){var getBalance=_ref2.getBalance,address=_ref2.address,rst=!1;try{var res=await getBalance(address);res=Object.values(res)[0],rst=Object.values(res).reduce((function(acc,m){return!!acc||(acc||new bn_default.a(Object(utils.c)(m),16).gt(ZERO))}),rst)}catch(err){}return rst},compose=__webpack_require__(1167),browser_passworder=__webpack_require__(1149),NAME="wallet_discoverAccounts",limitSchema=["limit",{optional:!0},[spec.int,{min:1,max:100,doc:"how many derivation we try, default to 10"}]],schemas={input:[spec.map,{closed:!0},["accountGroupId",spec.dbid],["waitTillFinish",{optional:!0},[spec.maybe,spec.truep]],limitSchema]},permissions={external:["popup"],methods:["wallet_getBalance","wallet_getNextNonce","wallet_createAccount"],db:["getAccountGroupById","getNetwork","getPassword"]},main=async function(_ref){var _accountGroup$account,_accountGroup$account2,_ref$rpcs=_ref.rpcs,wallet_getBalance=_ref$rpcs.wallet_getBalance,wallet_getNextNonce=_ref$rpcs.wallet_getNextNonce,wallet_createAccount=_ref$rpcs.wallet_createAccount,_ref$db=_ref.db,getAccountGroupById=_ref$db.getAccountGroupById,getNetwork=_ref$db.getNetwork,getPassword=_ref$db.getPassword,_ref$params=_ref.params,accountGroupId=_ref$params.accountGroupId,_ref$params$limit=_ref$params.limit,limit=void 0===_ref$params$limit?10:_ref$params$limit,waitTillFinish=_ref$params.waitTillFinish,InvalidParams=_ref.Err.InvalidParams,accountGroup=getAccountGroupById(accountGroupId);if(!accountGroup)throw InvalidParams("Invalid accountGroupId, account group not found");var oldAccountsCount=null!==(_accountGroup$account=null===(_accountGroup$account2=accountGroup.account)||void 0===_accountGroup$account2?void 0:_accountGroup$account2.length)&&void 0!==_accountGroup$account?_accountGroup$account:0,vault=accountGroup.vault;if("hd"===vault.type){var mnemonic=vault.ddata||await Object(browser_passworder.decrypt)(getPassword(),vault.data),networks=getNetwork(),promises=Promise.all(networks.map((async function(_ref2){var name=_ref2.name,hdPath=_ref2.hdPath,token=_ref2.token,type=_ref2.type,netId=_ref2.netId;return await async function(){for(var _ref3=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},getBalance=_ref3.getBalance,getTxCount=_ref3.getTxCount,mnemonic=_ref3.mnemonic,hdPath=_ref3.hdPath,_ref3$startFrom=_ref3.startFrom,startFrom=void 0===_ref3$startFrom?0:_ref3$startFrom,_ref3$max=_ref3.max,max=void 0===_ref3$max?10:_ref3$max,_ref3$only0x1Prefixed=_ref3.only0x1Prefixed,only0x1Prefixed=void 0!==_ref3$only0x1Prefixed&&_ref3$only0x1Prefixed,_ref3$return=_ref3.return0,return0=void 0!==_ref3$return&&_ref3$return,onFindOne=_ref3.onFindOne,found=[],i=startFrom;i<startFrom+max;i++){var rst=await Object(hdkey.a)({mnemonic:mnemonic,hdPath:hdPath,nth:i,only0x1Prefixed:only0x1Prefixed}),_await$Promise$all2=_slicedToArray(await Promise.all([hasTx({getTxCount:getTxCount,address:rst.address}),hasBalance({getBalance:getBalance,address:rst.address})]),2),txOk=_await$Promise$all2[0],balanceOk=_await$Promise$all2[1];if(!(return0&&0===i||txOk||balanceOk))return found;Object(checks.b)(onFindOne)&&await onFindOne(Object.assign({},rst,{nth:i})),found.push(Object.assign({},rst,{nth:i}))}return found}({getBalance:async function(addr){return await wallet_getBalance({networkName:name,errorFallThrough:!0},{users:[Object(addr_by_network.a)({address:addr,networkType:type,networkId:netId,addressType:"user"})],tokens:["0x0"].concat((token||[]).map((function(t){return t.address})))})},getTxCount:Object(compose.b)(wallet_getNextNonce,{networkName:name}),mnemonic:mnemonic,hdPath:hdPath.value,return0:0===oldAccountsCount,startFrom:oldAccountsCount,max:limit})}))).then((async function(found){for(var accountNumToCreate=found.reduce((function(acc,net){return Math.max(acc,net.length)}),0),accountIds=[],i=0;i<accountNumToCreate;i++)accountIds.push(await wallet_createAccount({accountGroupId:accountGroupId}));return accountIds}));return waitTillFinish?await promises:void 0}}},339:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var addr_by_network=__webpack_require__(1186),_777=__webpack_require__(1229),lib_esm_interface=__webpack_require__(1454),compose=__webpack_require__(1167),base32_address=__webpack_require__(1147),lib_esm=__webpack_require__(1144);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var iface=new lib_esm_interface.a([{constant:!0,inputs:[{name:"users",type:"address[]"},{name:"tokens",type:"address[]"}],name:"balances",outputs:[{name:"",type:"uint256[]"}],payable:!1,stateMutability:"view",type:"function"}]),encode=function(){var users=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],tokens=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return iface.encodeFunctionData("balances",[users,tokens])},decode=function(data){return iface.decodeFunctionResult("balances",data)},balances=async function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var request=args[0],to=args[1],_args$=args[2],users=void 0===_args$?[]:_args$,_args$2=args[3],tokens=void 0===_args$2?[]:_args$2;if(1===args.length)return Object(compose.b)(balances,request);if(2===args.length)return Object(compose.b)(balances,request,to);var data=await request({data:encode(users.map((function(u){return u.includes(":")?Object(base32_address.a)(u).hexAddress:u})),tokens.map((function(t){return"0x0"===t?"0x0000000000000000000000000000000000000000":t.includes(":")?Object(base32_address.a)(t).hexAddress:t}))),to:to}),_decode=decode(data),_decode2=_slicedToArray(_decode,1),decoded=_decode2[0],tl=tokens.length,rst={};return users.forEach((function(u,uidx){u=u.toLowerCase(),rst[u]={},tokens.forEach((function(t,tidx){t=t.toLowerCase(),rst[u][t]=Object(lib_esm.f)(decoded[uidx*tl+tidx].toHexString())}))})),rst},spec=__webpack_require__(1143);function wallet_getBalance_slicedToArray(arr,i){return function wallet_getBalance_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function wallet_getBalance_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function wallet_getBalance_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return wallet_getBalance_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wallet_getBalance_arrayLikeToArray(o,minLen)}(arr,i)||function wallet_getBalance_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wallet_getBalance_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var NAME="wallet_getBalance",GetBalanceSchema=[spec.or,[spec.cat,spec.ethHexAddress,[spec.zeroOrOne,spec.blockRef]],[spec.cat,spec.base32UserAddress,[spec.zeroOrOne,spec.epochRef]]],SingleCallGetBalanceSchema=[spec.or,[spec.map,{closed:!0},["users",[spec.oneOrMore,[spec.catn,["user-address",spec.base32UserAddress]]]],["tokens",[spec.oneOrMore,[spec.catn,["token-address",[spec.or,{doc:"token address, 0x0 represents native token"},[spec.eq,"0x0"],spec.base32ContractAddress]]]]]],[spec.map,{closed:!0},["users",[spec.oneOrMore,[spec.catn,["user-address",spec.ethHexAddress]]]],["tokens",[spec.oneOrMore,[spec.catn,["token-address",[spec.or,{doc:"token address, 0x0 represents native token"},[spec.eq,"0x0"],spec.ethHexAddress]]]]]]],schemas={input:[spec.or,GetBalanceSchema,SingleCallGetBalanceSchema]},permissions={locked:!0,methods:["cfx_getBalance","eth_getBalance","cfx_call","eth_call"],external:["popup","inpage"]},fallbackBalanceTracker=async function(callMethod,_ref){var _ref$rpcs=_ref.rpcs,cfx_getBalance=_ref$rpcs.cfx_getBalance,eth_getBalance=_ref$rpcs.eth_getBalance,_ref$params=_ref.params,users=_ref$params.users,tokens=_ref$params.tokens,type=_ref.network.type,getBalanceMethod="cfx"===type?cfx_getBalance:eth_getBalance,rst={},promises=users.reduce((function(acc,u){return u=u.toLowerCase(),rst[u]||(rst[u]={}),acc.concat(tokens.map((async function(t){var res="0x0",call="0x0"===(t=t.toLowerCase())?function(addr){return getBalanceMethod([addr])}:_777.a.balanceOf((function(d){return callMethod([d])}),t);try{var _res,_res$toHexString;res=await call("cfx"===type&&"0x0"!==t?Object(base32_address.a)(u).hexAddress:u),Array.isArray(res)&&(res=res[0]),res=Object(lib_esm.f)((null===(_res=res)||void 0===_res||null===(_res$toHexString=_res.toHexString)||void 0===_res$toHexString?void 0:_res$toHexString.call(_res))||res)}catch(err){}return rst[u][t]=res,res})))}),[]);return await Promise.all(promises),rst},main=async function(arg){var InvalidParams=arg.Err.InvalidParams,_arg$rpcs=arg.rpcs,cfx_getBalance=_arg$rpcs.cfx_getBalance,eth_getBalance=_arg$rpcs.eth_getBalance,cfx_call=_arg$rpcs.cfx_call,eth_call=_arg$rpcs.eth_call,params=arg.params,_arg$network=arg.network,type=_arg$network.type,netId=_arg$network.netId,balanceChecker=_arg$network.balanceChecker;if(Array.isArray(params)){var address=wallet_getBalance_slicedToArray(params,1)[0];address=Object(addr_by_network.a)({address:address,networkType:type,networkId:netId,addressType:"user"});var getBalance="cfx"===type?cfx_getBalance:eth_getBalance;return await getBalance([address])}var rst,callMethod="cfx"===type?cfx_call:eth_call,users=params.users,tokens=params.tokens;if("cfx"===type&&!users[0].includes(":")||"eth"===type&&users[0].includes(":"))throw InvalidParams("Invalid address format for current network");if(!balanceChecker)return rst=await fallbackBalanceTracker(callMethod,arg);try{rst=await balances((function(d){return callMethod({errorFallThrough:!0},[d])}),balanceChecker,users,tokens)}catch(err){}return void 0===rst&&(rst=await fallbackBalanceTracker(callMethod,arg)),rst}},340:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"NAME",(function(){return NAME})),__webpack_require__.d(__webpack_exports__,"TokenListSchema",(function(){return TokenListSchema})),__webpack_require__.d(__webpack_exports__,"InnerTokenListSchema",(function(){return InnerTokenListSchema})),__webpack_require__.d(__webpack_exports__,"schemas",(function(){return schemas})),__webpack_require__.d(__webpack_exports__,"permissions",(function(){return permissions})),__webpack_require__.d(__webpack_exports__,"validateAndFormatTokenList",(function(){return validateAndFormatTokenList})),__webpack_require__.d(__webpack_exports__,"main",(function(){return main}));var spec=__webpack_require__(1143);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var map=spec.map,url=spec.url,dbid=spec.dbid,nickname=spec.nickname,validate=spec.validate,explain=spec.explain,NAME="wallet_updateTokenList",TokenListSchema=function(_ref){var map=_ref.map,stringp=_ref.stringp,and=_ref.and,or=_ref.or,regexp=_ref.regexp,boolean=_ref.boolean,int=_ref.int,nil=_ref.nil,ethHexAddress=_ref.ethHexAddress,base32ContractAddress=_ref.base32ContractAddress,posInt=_ref.posInt,url=_ref.url,repeat=_ref.repeat,mapOf=_ref.mapOf,jsinst=_ref.jsinst,tokenSymbol=_ref.tokenSymbol,jssetp=_ref.jssetp,integer=_ref.integer,TagIdentifierSchema=[and,[stringp,{min:1,max:10}],[regexp,"^[\\w]+$"]];return[map,{closed:!0},["name",[and,[stringp,{min:1,max:20}],[regexp,"^[ \\w]+$"]]],["timestamp",jsinst],["version",[map,{closed:!0},["major",[integer,{min:0}]],["minor",[integer,{min:0}]],["patch",[integer,{min:0}]]]],["tokens",[repeat,{min:1,max:1e4},[map,{closed:!0},["chainId",int],["address",[or,ethHexAddress,base32ContractAddress]],["decimals",[posInt,{max:255}]],["name",[and,[regexp,"^[ \\w.'+\\-%\\/À-ÖØ-öø-ÿ:]+$"],[stringp,{min:1,max:40}]]],["symbol",tokenSymbol],["logoURI",{optional:!0},url],["tags",{optional:!0},[repeat,{min:0,max:10},TagIdentifierSchema]],["extensions",{optional:!0},[mapOf,{min:0,max:20},[and,[stringp,{min:1,max:30}],[regexp,"^[\\w]+$"]],[or,nil,boolean,int,[stringp,{min:1,max:42}]]]]]]],["keywords",{optional:!0},[and,[repeat,{min:1,max:20},[and,[stringp,{min:1,max:20}],[regexp,"^[ \\w]+$"]]],jssetp]],["tags",{optional:!0},[mapOf,{min:1,max:20},TagIdentifierSchema,[map,{closed:!0},["name",[and,[stringp,{min:1,max:20}],[regexp,"^[ \\w]+$"]]],["description",[and,[stringp,{min:1,max:200}],[regexp,"^[ \\w\\.,]+$"]]]]]],["logoURI",{optional:!0},url]]}(spec),InnerTokenListSchema=[map,{closed:!0},["url",url],["name",{optional:!0},nickname]],schemas={input:[map,{closed:!0},["tokenList",InnerTokenListSchema],["networkId",dbid]]},permissions={external:["popup"],methods:[],db:["t","getNetworkById","retract"]},validateAndFormatTokenList=function(_ref){var tokenList=_ref.tokenList,InvalidParams=_ref.InvalidParams;if(!validate(TokenListSchema,tokenList))throw InvalidParams(`Invalid token list format.\n${JSON.stringify(explain(TokenListSchema,tokenList),null,4)}`);var logoURI=tokenList.logoURI,tokens=tokenList.tokens,protocolRegex=new RegExp(/^https?:/,"i");if(!tokens.reduce((function(acc,_ref2){var logoURI=_ref2.logoURI;return!!acc&&(logoURI?protocolRegex.test(logoURI):acc)}),protocolRegex.test(logoURI)))throw InvalidParams("Unsupported logoURI protocol found in token list, only support http/https for now.")},main=async function(_ref3){var _oldTokenList$token,tokenList,InvalidParams=_ref3.Err.InvalidParams,_ref3$db=_ref3.db,getNetworkById=_ref3$db.getNetworkById,t=_ref3$db.t,retract=_ref3$db.retract,_ref3$params=_ref3.params,_ref3$params$tokenLis=_ref3$params.tokenList,url=_ref3$params$tokenLis.url,name=_ref3$params$tokenLis.name,networkId=_ref3$params.networkId,network=getNetworkById(networkId);if(!network)throw InvalidParams(`Invalid network id ${networkId}`);try{tokenList=await fetch(url).then((function(r){return r.json()}))}catch(err){throw InvalidParams(`Invalid token list ${url}`)}validateAndFormatTokenList({tokenList:tokenList,InvalidParams:InvalidParams}),name=name||tokenList.name;var _reduce2=_slicedToArray((network.token||[]).reduce((function(acc,_ref4,idx){var address=_ref4.address;return[[].concat(_toConsumableArray(acc[0]),[idx]),[].concat(_toConsumableArray(acc[1]),[address])]}),[[],[]]),2),existTokensIdx=_reduce2[0],existTokensAddr=_reduce2[1],oldTokenList=network.tokenList,oldTokens=(null==oldTokenList||null===(_oldTokenList$token=oldTokenList.token)||void 0===_oldTokenList$token?void 0:_oldTokenList$token.reduce((function(acc,_ref5){var eid=_ref5.eid,fromApp=_ref5.fromApp,fromUser=_ref5.fromUser;return fromApp||fromUser?acc:acc.concat([eid])}),[]))||[];oldTokenList&&retract(oldTokenList.eid),oldTokens.forEach(retract);var addTokenTxs=tokenList.tokens.reduce((function(acc,t,idx){var eid=-idx-1e4,dupIdx=existTokensAddr.indexOf(t.address);-1!==dupIdx&&(eid=network.token[existTokensIdx[dupIdx]].eid),t.fromList=!0;var addTokenTx={eid:eid,token:t},tokenIntoNetworkTx={eid:networkId,network:{token:eid}},tokenIntoTokenListTx={eid:-1,tokenList:{token:eid}};return[].concat(_toConsumableArray(acc),[addTokenTx,tokenIntoNetworkTx,tokenIntoTokenListTx])}),[{eid:-1,tokenList:{url:url,name:name,value:tokenList}},{eid:networkId,network:{tokenList:-1}}]);t(addTokenTxs)}}}]);